{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a75acfec",
   "metadata": {},
   "source": [
    "# Clean dataset using influence functions and neural networks\n",
    "\n",
    "This notebook shows how to calculate influences on a NN model using pyDVL for an arbitrary dataset.\n",
    "\n",
    "It uses the wine dataset from sklearn: given a set of 13 different input parameters regarding a particular bottle, each related to some physical property (e.g. concentration of magnesium, malic acidity, alcoholic percentage, etc), the model will need to predict to which of 3 classes the wine belongs to. For more details, please refer to the [sklearn documentation](https://scikit-learn.org/stable/datasets/toy_dataset.html#wine-recognition-dataset)."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68ec440b",
   "metadata": {},
   "source": [
    "Let's start by loading the imports, the dataset and splitting it into train, validation and test sets. We will use a large test set to have a less noisy estimate of the average influence."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "be813151",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:15.368171Z",
     "iopub.status.busy": "2022-09-27T15:50:15.367493Z",
     "iopub.status.idle": "2022-09-27T15:50:18.267737Z",
     "shell.execute_reply": "2022-09-27T15:50:18.266362Z"
    }
   },
   "outputs": [],
   "source": [
    "from valuation.utils.dataset import load_wine_dataset\n",
    "import matplotlib.pyplot as plt\n",
    "import torch\n",
    "from valuation.influence.model_wrappers import TorchNeuralNetwork\n",
    "import torch.nn.functional as F\n",
    "from torch.optim import Adam, lr_scheduler\n",
    "import numpy as np\n",
    "from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay, f1_score\n",
    "\n",
    "train_ds, val_ds, test_ds = load_wine_dataset(train_size=0.3, test_size=0.6)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a018e72c",
   "metadata": {},
   "source": [
    "## Fit a neural network to the data\n",
    "\n",
    "We will train a 2-layer neural network. PyDVL has some convenience wrappers to initialize a pytorch NN. If you already have a model loaded and trained, you can skip this section."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "00dc59af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:18.275667Z",
     "iopub.status.busy": "2022-09-27T15:50:18.274610Z",
     "iopub.status.idle": "2022-09-27T15:50:20.548585Z",
     "shell.execute_reply": "2022-09-27T15:50:20.547289Z"
    }
   },
   "outputs": [],
   "source": [
    "feature_dimension = train_ds[0].shape[1]\n",
    "unique_classes = np.unique(np.concatenate((train_ds[1], test_ds[1])))\n",
    "num_classes = len(unique_classes)\n",
    "network_size = [16, 16]\n",
    "\n",
    "num_epochs = 300\n",
    "lr = 0.005\n",
    "weight_decay = 0.01\n",
    "device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n",
    "\n",
    "nn = TorchNeuralNetwork(feature_dimension, num_classes, network_size)\n",
    "nn.to(device)\n",
    "optimizer = Adam(params=nn.parameters(), lr=lr, weight_decay=weight_decay)\n",
    "scheduler = lr_scheduler.CosineAnnealingLR(optimizer, T_max=num_epochs)\n",
    "\n",
    "train_loss, val_loss = nn.fit(\n",
    "    x_train=train_ds[0],\n",
    "    y_train=train_ds[1],\n",
    "    x_val=val_ds[0],\n",
    "    y_val=val_ds[1],\n",
    "    loss=F.cross_entropy,\n",
    "    optimizer=optimizer,\n",
    "    scheduler=scheduler,\n",
    "    num_epochs=num_epochs,\n",
    "    batch_size=16,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a3ba188",
   "metadata": {},
   "source": [
    "Let's check that the training has found a stable minimum by plotting the train and validation loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f4b57b77",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:20.556597Z",
     "iopub.status.busy": "2022-09-27T15:50:20.555862Z",
     "iopub.status.idle": "2022-09-27T15:50:20.860579Z",
     "shell.execute_reply": "2022-09-27T15:50:20.859434Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAzoAAAJGCAYAAACTJvC6AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjYuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy89olMNAAAACXBIWXMAAA9hAAAPYQGoP6dpAABOdUlEQVR4nO3deZRU9Z3//9etvatXoKEbEAEVtyitojAdJxmNfIPgcIzZjJoRmcT8TCSTyJhEHJeJ+U7IiQmDk5g4842GWZLoJEHNRGNCMOKYEI0IcYkQURCEbpqtl1q61vv7o5auarqhq7uq7q3q5+OcOnXrbvWuuhby4rNcwzRNUwAAAABQRRxWFwAAAAAAxUbQAQAAAFB1CDoAAAAAqg5BBwAAAEDVIegAAAAAqDoEHQAAAABVh6ADAAAAoOq4rC5gJJLJpPbv36/6+noZhmF1OQAAAAAsYpqm+vr6NG3aNDkcw7fbVETQ2b9/v2bMmGF1GQAAAABsYu/evTrppJOG3V4RQae+vl5S6sM0NDRYXA0AAAAAq/T29mrGjBnZjDCcigg6me5qDQ0NBB0AAAAAJxzSwmQEAAAAAKoOQQcAAABA1SHoAAAAAKg6FTFGBwAAAKgkiURCsVjM6jIqktvtltPpHPN5CDoAAABAkZimqc7OTnV3d1tdSkVrampSa2vrmO6hSdABAAAAiiQTcqZMmSK/38/N7gtkmqZCoZC6urokSVOnTh31uQg6AAAAQBEkEolsyJk0aZLV5VSsmpoaSVJXV5emTJky6m5sTEYAAAAAFEFmTI7f77e4ksqX+Q7HMs6JoAMAAAAUEd3Vxq4Y3yFBBwAAAEDVIegAAAAAKJpZs2Zp7dq1VpfBZAQAAADAeHfJJZfovPPOK0pA+cMf/qDa2tqxFzVGBB0AAAAAx2WaphKJhFyuE8eHyZMnl6GiE6PrGgAAADCO3XDDDdq0aZPuu+8+GYYhwzC0bt06GYahX/ziF5o3b568Xq+ee+45vfnmm7ryyivV0tKiuro6XXTRRfr1r3+dd77BXdcMw9D3vvc9XXXVVfL7/ZozZ45+9rOflfxzEXQAAACAEjFNU6Fo3JKHaZojqvG+++5Te3u7brzxRnV0dKijo0MzZsyQJN1222362te+ptdff11z585VIBDQkiVLtHHjRm3dulWXX365li5dqj179hz3Pb785S/rox/9qF5++WUtWbJE1113nY4cOTLm7/d46LoGAAAAlEg4ltDZd/3Skvf+0z2L5Pec+K/7jY2N8ng88vv9am1tlSRt375dknTPPffo//yf/5Pdd+LEiWpra8u+/spXvqJHH31UP/vZz7RixYph3+OGG27QNddcI0n66le/qn/5l3/RCy+8oMsvv3xUn20kaNEBAAAAMKQLL7ww73UgENCtt96qs846S01NTaqrq9Prr79+whaduXPnZpdra2vV0NCgrq6uktScQYsOAAAAUCI1bqf+dM8iy957rAbPnnbrrbdqw4YN+sY3vqHTTjtNNTU1+vCHP6xoNHrc87jd7rzXhmEomUyOub7jIegAAAAAJWIYxoi6j1nN4/EokUiccL/f/va3uuGGG3TVVVdJSrXw7N69u8TVjQ5d1wAAAIBxbtasWXr++ee1e/duHTp0aNjWljlz5mj9+vXatm2b/vjHP+raa68tecvMaBF0CmCapp5/67B+s6NLkfiJEy8AAABQCW699VY5nU6dffbZmjx58rBjbtasWaMJEybo3e9+t5YuXapFixbpggsuKHO1I2OYI513zkK9vb1qbGxUT0+PGhoaLK3ltNufVDxp6verLlNro8/SWgAAAGAf/f392rVrl2bPni2fj78njsXxvsuRZgNadAqUGdQVisYtrgQAAADAcAg6BarxpIJOOEbXNQAAAMCuCDoFygadKEEHAAAAsCuCToEyXddo0QEAAADsi6BToEyLTogWHQAAAMC2CDoF8qeDTj8tOgAAAIBtEXQKNDDrGkEHAAAAsCuCToFqPC5JTEYAAAAA2BlBp0A17tRXxmQEAAAAgH0RdArkp0UHAAAAyDNr1iytXbvW6jLyEHQK5GOMDgAAAGB7BJ0CZWZdo+saAAAAYF8EnQJlbxgajVtcCQAAADB2//Zv/6Zp06YpmUzmrb/yyiv1t3/7t3rzzTd15ZVXqqWlRXV1dbrooov061//2qJqR46gU6AaWnQAAAAwUqYpRYPWPExzRCV+5CMf0eHDh/Wb3/wmu+7IkSN66qmndN111ykQCGjJkiXauHGjtm7dqssvv1xLly7Vnj17SvWtFYXL6gIqDffRAQAAwIjFQtJXp1nz3rfvlzy1J9xtwoQJWrx4sX74wx/qsssukyT95Cc/UXNzsy699FI5HA61tbVl9//KV76iRx99VD/7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EnQK8Mgjj2jlypW6++679dJLL6mtrU2LFi1SV1eX1aVhhN71rnepo6Mj+3juueey22655Rb9z//8j3784x9r06ZN2r9/vz74wQ9aWC2GEgwG1dbWpvvvv3/I7V//+tf1L//yL3rggQf0/PPPq7a2VosWLVJ/f392n+uuu06vvfaaNmzYoJ///Od69tln9alPfapcHwFDONF1laTLL7887/f7ox/9KG8719VeNm3apJtvvlm///3vtWHDBsViMb3//e9XMBjM7nOiP3cTiYSuuOIKRaNR/e53v9O///u/a926dbrrrrus+EjQyK6rJN144415v9evf/3r2W1cV/s56aST9LWvfU1btmzRiy++qPe973268sor9dprr0mq4N+qiRGbP3++efPNN2dfJxIJc9q0aebq1astrAojdffdd5ttbW1Dbuvu7jbdbrf54x//OLvu9ddfNyWZmzdvLlOFKJQk89FHH82+TiaTZmtrq3nvvfdm13V3d5ter9f80Y9+ZJqmaf7pT38yJZl/+MMfsvv84he/MA3DMPft21e22jG8wdfVNE1z2bJl5pVXXjnsMVxX++vq6jIlmZs2bTJNc2R/7j755JOmw+EwOzs7s/t897vfNRsaGsxIJFLeD4AhDb6upmmaf/VXf2V+7nOfG/YYrmtlmDBhgvm9732von+rtOiMUDQa1ZYtW7Rw4cLsOofDoYULF2rz5s0WVoZCvPHGG5o2bZpOOeUUXXfdddqzZ48kacuWLYrFYnnX98wzz9TJJ5/M9a0gu3btUmdnZ951bGxs1IIFC7LXcfPmzWpqatKFF16Y3WfhwoVyOBx6/vnny14zRu6ZZ57RlClTdMYZZ+jTn/60Dh8+nN3GdbW/np4eSdLEiRMljezP3c2bN+vcc89VS0tLdp9Fixapt7c3+y/NsNbg65rxgx/8QM3NzTrnnHO0atUqhUKh7Dauq70lEgk9/PDDCgaDam9vr+jfqsuyd64whw4dUiKRyLuAktTS0qLt27dbVBUKsWDBAq1bt05nnHGGOjo69OUvf1nvec979Oqrr6qzs1Mej0dNTU15x7S0tKizs9OaglGwzLUa6nea2dbZ2akpU6bkbXe5XJo4cSLX2sYuv/xyffCDH9Ts2bP15ptv6vbbb9fixYu1efNmOZ1OrqvNJZNJff7zn9fFF1+sc845R5JG9OduZ2fnkL/nzDZYa6jrKknXXnutZs6cqWnTpunll1/Wl770Je3YsUPr16+XxHW1q1deeUXt7e3q7+9XXV2dHn30UZ199tnatm1bxf5WCToYNxYvXpxdnjt3rhYsWKCZM2fqv//7v1VTU2NhZQBO5GMf+1h2+dxzz9XcuXN16qmn6plnntFll11mYWUYiZtvvlmvvvpq3rhIVL7hrmvu2Lhzzz1XU6dO1WWXXaY333xTp556arnLxAidccYZ2rZtm3p6evSTn/xEy5Yt06ZNm6wua0zoujZCzc3Ncjqdx8wwceDAAbW2tlpUFcaiqalJp59+unbu3KnW1lZFo1F1d3fn7cP1rSyZa3W832lra+sxE4jE43EdOXKEa11BTjnlFDU3N2vnzp2SuK52tmLFCv385z/Xb37zG5100knZ9SP5c7e1tXXI33NmG6wz3HUdyoIFCyQp7/fKdbUfj8ej0047TfPmzdPq1avV1tam++67r6J/qwSdEfJ4PJo3b542btyYXZdMJrVx40a1t7dbWBlGKxAI6M0339TUqVM1b948ud3uvOu7Y8cO7dmzh+tbQWbPnq3W1ta869jb26vnn38+ex3b29vV3d2tLVu2ZPd5+umnlUwms/8zhv298847Onz4sKZOnSqJ62pHpmlqxYoVevTRR/X0009r9uzZedtH8udue3u7XnnllbwQu2HDBjU0NOjss88uzwdBnhNd16Fs27ZNkvJ+r1xX+0smk4pEIpX9W7VsGoQK9PDDD5ter9dct26d+ac//cn81Kc+ZTY1NeXNMAH7+vu//3vzmWeeMXft2mX+9re/NRcuXGg2NzebXV1dpmma5k033WSefPLJ5tNPP22++OKLZnt7u9ne3m5x1Risr6/P3Lp1q7l161ZTkrlmzRpz69at5ttvv22apml+7WtfM5uamszHH3/cfPnll80rr7zSnD17thkOh7PnuPzyy83zzz/ffP75583nnnvOnDNnjnnNNddY9ZFgHv+69vX1mbfeequ5efNmc9euXeavf/1r84ILLjDnzJlj9vf3Z8/BdbWXT3/602ZjY6P5zDPPmB0dHdlHKBTK7nOiP3fj8bh5zjnnmO9///vNbdu2mU899ZQ5efJkc9WqVVZ8JJgnvq47d+4077nnHvPFF180d+3aZT7++OPmKaecYr73ve/NnoPraj+33XabuWnTJnPXrl3myy+/bN52222mYRjmr371K9M0K/e3StAp0Le+9S3z5JNPNj0ejzl//nzz97//vdUlYYSuvvpqc+rUqabH4zGnT59uXn311ebOnTuz28PhsPmZz3zGnDBhgun3+82rrrrK7OjosLBiDOU3v/mNKemYx7Jly0zTTE0xfeedd5otLS2m1+s1L7vsMnPHjh155zh8+LB5zTXXmHV1dWZDQ4O5fPlys6+vz4JPg4zjXddQKGS+//3vNydPnmy63W5z5syZ5o033njMPzJxXe1lqOspyfz+97+f3Wckf+7u3r3bXLx4sVlTU2M2Nzebf//3f2/GYrEyfxpknOi67tmzx3zve99rTpw40fR6veZpp51mfuELXzB7enryzsN1tZe//du/NWfOnGl6PB5z8uTJ5mWXXZYNOaZZub9VwzRNs3ztRwAAAABQeozRAQAAAFB1CDoAAAAAqg5BBwAAAEDVIegAAAAAqDoEHQAAAABVh6ADAAAAoOoQdAAAAABUHYIOAAAAgKpD0AEAAABQdQg6AAAAAKoOQQcAAABA1fn/AVYgNFsMjZJAAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 1000x700 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(10, 7))\n",
    "plt.plot(train_loss, label=\"train\")\n",
    "plt.plot(val_loss, label=\"val\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b3345522",
   "metadata": {},
   "source": [
    "Since it is a classification problem, let's also take a look at the confusion matrix on the test set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "08f1cba4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:20.867375Z",
     "iopub.status.busy": "2022-09-27T15:50:20.866722Z",
     "iopub.status.idle": "2022-09-27T15:50:21.268830Z",
     "shell.execute_reply": "2022-09-27T15:50:21.267665Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f15986fffa0>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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8YkOXdyp2qUvNt6hpKZ2XdypWoe+jNHba5rqigEVSmpq1/5PY/Xs7IvU9cpKtcuqvsBZEUr42YYnQiqRm13+602V3Myu2+4pVdMW9dr3SZweGNVWJ45xn2k4i4o2tHtbktY830LVpyLUIqNOV99wQjdPKgt0aPASfrb9hNeYel9lZaWKioqcn/fv36+CggKlpKSodevWAYwseL2+rLleX9Y80GHAxx5/9bufi9SL6vT71UXfszfCAT/bvufp09nC5slu3vTBBx+of//+zs9TpkyRJI0ePVrLly8PUFQAAISORi1227Ztm2699VZlZ2frq6++kiT9+c9/1jvvvOPWefr16yfDMM5pJHEAgNeF6WI3txP5q6++qsGDBysuLk67d+923tddXl6uRx55xOsBAgDgFSTyMx5++GE988wzeu655xQd/d1CjKuuukq7du3yanAAAOD7uT1HXlhYqD59+pzTn5ycrBMnTngjJgAAvC5cF7u5XZGnpaW5rDQ/65133lG7du28EhQAAF539slunrQg5HYiHz9+vCZOnKj33ntPFotFhw4d0ooVKzR16lTdddddvogRAADPhekcudtD6/fdd58cDocGDBigU6dOqU+fPrJarZo6daomTJjgixgBAMAFuJ3ILRaLHnjgAd1zzz0qKipSZWWlsrKylJiY6Iv4AADwinCdI2/0A2FiYmKUlZXlzVgAAPAdHtF6Rv/+/WWxXHjC/6233vIoIAAA0HBuL3br0aOHunfv7mxZWVmqra3Vrl271LVrV1/ECACA54zvhtcb09ytyOfPn69evXopKSlJqampGj58uAoLC132qa6uVk5Ojpo1a6bExESNHDlSZWXuvRDJ7Yr8iSeeOG//7NmzVVlZ6e7pAADwDz8Prefn5ysnJ0e9evVSfX297r//fg0aNEiffvqpEhISJEmTJ0/W3//+d/3tb39TcnKycnNzNWLECP3rX/9q8HW89tKUW2+9VVdccYV+//vfe+uUAACErPXr17t8Xr58uVJTU7Vz50716dNH5eXlWrp0qfLy8nTttddKkpYtW6bOnTtrx44duvLKKxt0nUa9NOV8tm/frtjYWG+dDgAA7/LSfeQVFRUu7ew7R35IeXm5JCklJUWStHPnTtXV1WngwIHOfTp16qTWrVtr+/btDf6y3K7IR4wY4fLZMAwdPnxYH3zwgWbM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AC6MRI6wlZCQoPbt2zd4/8suu0yrVq1SamrqOVXpWenp6XrvvffUp08fSWcqz507d+qyyy477/5du3aVw+FQfn6+Bg4ceM72syMCdrvd2ZeVlSWr1aoDBw5csJLv3Lmzc+HeWTt27PjhL/K/vPvuu2rTpo0eeOABZ99//vOfc/Y7cOCADh06pIyMDOd1IiIi1LFjR7Vs2VIZGRnat2+fRo0a5db1AXgHi92Ab40aNUrNmzfXsGHDtG3bNu3fv19btmzRb3/7Wx08eFCSNHHiRD366KNau3atPvvsM919993few/4xRdfrNGjR+vXv/611q5d6zznyy+/LElq06aNLBaL1q1bp6NHj6qyslJJSUmaOnWqJk+erBdffFHFxcXatWuX/vjHPzoXkN1555364osvdM8996iwsFB5eXlavny5W1/vpZdeqgMHDmjlypUqLi7WokWLzrtwLzY2VqNHj9aHH36obdu26be//a1uuukmpaWlSZLmzJmj+fPna9GiRfr888/10UcfadmyZVqwYIFb8QBoHBI58K34+Hht3bpVrVu31ogRI9S5c2eNGzdO1dXVzgr9d7/7nf7v//5Po0ePVnZ2tpKSkvTzn//8e8+7ZMkS/eIXv9Ddd9+tTp06afz48aqqqpIkXXTRRZozZ47uu+8+tWzZUrm5uZKkhx56SDNmzND8+fPVuXNnXX/99fr73/+utm3bSjozb/3qq69q7dq16t69u5555hk98sgjbn29N954oyZPnqzc3Fz16NFD7777rmbMmHHOfu3bt9eIESN0ww03aNCgQerWrZvL7WW33367nn/+eS1btkxdu3ZV3759tXz5cmesAHzLYlxolQ4AAAh6VOQAAIQwEjkAACGMRA4AQAgjkQMAEMJI5AAAhDASOQAAIYxEDgBACCORAwAQwkjkAACEMBI5AAAhjEQOAEAII5EDABDC/h+I+QI7EuCOkAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 640x480 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "pred_y_test = np.argmax(nn(test_ds[0]).detach(), axis=1)\n",
    "\n",
    "cm = confusion_matrix(test_ds[1], pred_y_test)\n",
    "disp = ConfusionMatrixDisplay(confusion_matrix=cm)\n",
    "disp.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cca76db8",
   "metadata": {},
   "source": [
    "And let's compute the f1 score of the model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ca48f9d5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:21.275345Z",
     "iopub.status.busy": "2022-09-27T15:50:21.274967Z",
     "iopub.status.idle": "2022-09-27T15:50:21.289162Z",
     "shell.execute_reply": "2022-09-27T15:50:21.287621Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9627778792505728"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f1_score(test_ds[1], pred_y_test, average=\"weighted\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5332e2b4",
   "metadata": {},
   "source": [
    "Let's now move to calculating influences of each point on the total score."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "45dbdd1e",
   "metadata": {},
   "source": [
    "## Calculating influences for small neural networks\n",
    "\n",
    "The following cell calculates the influences of each training data-point on the neural network error. \n",
    "The calculation of the Hessian matrix (necessary to calculate the influences) can be quite numerically challenging, but there are some techniques to speed up the calculation. PyDVL allows to use the full method (\"direct\") or the conjugate gradient method (\"cg\"). The first one should be used only for very small networks (like our current example), while for bigger ones \"cg\" is advisable."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "218d0983",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:21.296430Z",
     "iopub.status.busy": "2022-09-27T15:50:21.296072Z",
     "iopub.status.idle": "2022-09-27T15:50:22.137961Z",
     "shell.execute_reply": "2022-09-27T15:50:22.136670Z"
    }
   },
   "outputs": [],
   "source": [
    "from valuation.influence.general import influences\n",
    "\n",
    "inversion_method = \"direct\"  # cg for big networks\n",
    "\n",
    "train_influences = influences(\n",
    "    nn, F.cross_entropy, *train_ds, *test_ds, inversion_method=inversion_method\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce21c2dc",
   "metadata": {},
   "source": [
    "the returned matrix, train_influences, has a quantity of columns equal to the points in the training set, and a number of rows equal to the points in the test set. At each element $a_{i,j}$ it stores the influence that training point $j$ has on the classification of test point $i$."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4153c7db",
   "metadata": {},
   "source": [
    "If we take the average across every column of the influences matrix, we obtain an estimate of the overall influence of a training point on the total accuracy of the network."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "9169c2dc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:22.145837Z",
     "iopub.status.busy": "2022-09-27T15:50:22.145193Z",
     "iopub.status.idle": "2022-09-27T15:50:22.154548Z",
     "shell.execute_reply": "2022-09-27T15:50:22.153572Z"
    }
   },
   "outputs": [],
   "source": [
    "mean_train_influences = np.mean(train_influences, axis=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b5e254ad",
   "metadata": {},
   "source": [
    "The following histogram shows that there are big differences in score within the training set (notice the log-scale on the y axis)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "233a57da",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:22.163619Z",
     "iopub.status.busy": "2022-09-27T15:50:22.161037Z",
     "iopub.status.idle": "2022-09-27T15:50:22.928152Z",
     "shell.execute_reply": "2022-09-27T15:50:22.926872Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'number of points')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA1EAAAJwCAYAAABoAuuNAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjYuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy89olMNAAAACXBIWXMAAA9hAAAPYQGoP6dpAAA990lEQVR4nO3deZgV9Zno8fc00DRLN0tEFEUQ0ChGQNlERTCiwOXqgKgZdJS4xA1FxSWYZATc4Bo1ztVO3CbimEWjRpMRRYTBBSQKihoEURE3EFGRTWTrrvtHHvqmZZEfdtMNfD7P04+cOnXqvKerEb5UnTq5LMuyAAAAYKvkVfUAAAAAOxIRBQAAkEBEAQAAJBBRAAAACUQUAABAAhEFAACQQEQBAAAkEFEAAAAJRBQAAEACEQVQjaxcuTLOOeec2GOPPSKXy8Wll14a77//fuRyuRg7dmxVj8d3NHLkyMjlcuWWtWzZMn784x9X+nNv6ufoxz/+cdSvX7/Sn3uDXC4XI0eO3G7PB1BZRBRABRo7dmzkcrmYMWPGNj3+xhtvjLFjx8YFF1wQDzzwQJx++ukVPCE7gyeffLLaxkh1ng2gotSs6gEA+P/+53/+Jw477LAYMWJE2bL333+/6gai0s2dOzfy8tL+TfPJJ5+M4uLipFhp0aJFfP3111GrVq3ECdNsabavv/46atb0Vw9gx+dIFEA1snjx4mjYsGFVj7HTWr16dZSWllb1GOXUrl27UsNm/fr1sXbt2sjlclFQUBA1atSotOf6NgUFBSIK2CmIKIBKtuF9JwsWLIj+/ftH/fr1o0mTJnHFFVdESUlJREQ8++yzkcvlYv78+TFu3LjI5XKRy+U2exSqZ8+e0bNnz00+V8uWLcstKy0tjdtuuy0OOuigKCgoiKZNm8Z5550XX3755UaPf+qpp6JHjx5RWFgYRUVF0blz5/jDH/5Qbp2XXnop+vTpEw0aNIi6detGjx49YurUqVv1vbj99tvjoIMOirp160ajRo2iU6dOG21/wYIFcfbZZ0ezZs2idu3ase+++8YFF1wQa9euLVvnvffei5NPPjkaN24cdevWjcMOOyzGjRtXbjsbvqcPPvhg/OIXv4i99tor6tatG8uXL9/q17FixYq49NJLo2XLllG7du3Yfffd49hjj41XX331W1/rlClTonPnzlFQUBCtW7eOu+66a5PrffM9UevWrYtRo0bFfvvtFwUFBfG9730vjjzyyHjmmWci4h/7uLi4OCKi7Odkw/usNrzv6eabb47bbrstWrduHbVr147Zs2dv8b117733XvTu3Tvq1asXzZo1i2uvvTayLNvoe/nss8+We9w3t7ml2TYs++YRqpkzZ0bfvn2jqKgo6tevH8ccc0z87W9/K7fOhtNkp06dGsOGDYsmTZpEvXr1YsCAAfHZZ59tegcAVCL/HASwHZSUlETv3r2ja9eucfPNN8fEiRPjlltuidatW8cFF1wQBx54YDzwwANx2WWXxd577x2XX355REQ0adLkO/8l8bzzzouxY8fGmWeeGUOHDo358+fHHXfcETNnzoypU6eWHQUZO3ZsnHXWWXHQQQfF1VdfHQ0bNoyZM2fG+PHj49RTT42If5xu2Ldv3+jYsWOMGDEi8vLy4r777osf/vCH8cILL0SXLl02O8c999wTQ4cOjZNOOikuueSSWL16dbzxxhvx0ksvlW1/4cKF0aVLl1i6dGmce+65ccABB8SCBQvikUceiVWrVkV+fn58+umncfjhh8eqVati6NCh8b3vfS/uv//+OOGEE+KRRx6JAQMGlHve6667LvLz8+OKK66INWvWRH5+/la/jvPPPz8eeeSRuOiii6Jt27bxxRdfxJQpU2LOnDlx6KGHbva1/v3vf4/jjjsumjRpEiNHjoz169fHiBEjomnTpt+6v0aOHBmjR4+Oc845J7p06RLLly+PGTNmxKuvvhrHHntsnHfeebFw4cJ45pln4oEHHtjkNu67775YvXp1nHvuuVG7du1o3LjxZo/AlZSURJ8+feKwww6Lm266KcaPHx8jRoyI9evXx7XXXvut8/6zrZntn7355pvRvXv3KCoqiquuuipq1aoVd911V/Ts2TOee+656Nq1a7n1L7744mjUqFGMGDEi3n///bjtttvioosuioceeihpToDvLAOgwtx3331ZRGTTp08vWzZ48OAsIrJrr7223LqHHHJI1rFjx3LLWrRokfXr16/csvnz52cRkd13331ly3r06JH16NFjo+cfPHhw1qJFi7LbL7zwQhYR2e9///ty640fP77c8qVLl2aFhYVZ165ds6+//rrcuqWlpWX/3W+//bLevXuXLcuyLFu1alW27777Zscee+xmviv/8C//8i/ZQQcdtMV1zjjjjCwvL6/c9++bc1x66aVZRGQvvPBC2X0rVqzI9t1336xly5ZZSUlJlmVZNnny5CwislatWmWrVq0qt52tfR0NGjTIhgwZssWZN6V///5ZQUFB9sEHH5Qtmz17dlajRo3sm3/0tmjRIhs8eHDZ7fbt22/0M/BNQ4YM2Wg7Wfb/f1aKioqyxYsXb/K+f/452vCzefHFF5ctKy0tzfr165fl5+dnn332WZZl//97OXny5G/d5uZmy7Isi4hsxIgRZbf79++f5efnZ/PmzStbtnDhwqywsDA76qijypZt+H3Vq1evcvvssssuy2rUqJEtXbp0k88HUFmczgewnZx//vnlbnfv3j3ee++9Sn3Ohx9+OBo0aBDHHntsfP7552VfHTt2jPr168fkyZMjIuKZZ56JFStWxPDhw6OgoKDcNjacjvXaa6/FO++8E6eeemp88cUXZdv66quv4phjjonnn39+i+83atiwYXz88ccxffr0Td5fWloajz/+eBx//PHRqVOnje7fMMeTTz4ZXbp0iSOPPLLsvvr168e5554b77//fsyePbvc4wYPHhx16tQpu53yOho2bBgvvfRSLFy4cLOv65tKSkri6aefjv79+8c+++xTtvzAAw+M3r17f+vjGzZsGG+++Wa88847W/2c3zRw4MBo0qTJVq9/0UUXlf06l8vFRRddFGvXro2JEydu8wzfpqSkJCZMmBD9+/ePVq1alS3fc88949RTT40pU6aUnXq5wbnnnlvu9MDu3btHSUlJfPDBB5U2J8CmiCiA7aCgoGCjv9Q2atRok+9LqkjvvPNOLFu2LHbfffdo0qRJua+VK1fG4sWLIyJi3rx5ERHxgx/8YIvbivhHlHxzW/fee2+sWbMmli1bttnH//SnP4369etHly5dYr/99oshQ4aUew/SZ599FsuXL9/iDBERH3zwQXz/+9/faPmBBx5Ydv8/23fffbf5ddx0000xa9asaN68eXTp0iVGjhz5reH72Wefxddffx377bffRvdtau5vuvbaa2Pp0qWx//77x8EHHxxXXnllvPHGG9/6uH/2zde8JXl5eeUiJiJi//33j4jKvTLkZ599FqtWrdrsviwtLY2PPvqo3PJ/jtKIf/weiohK/30E8E3eEwWwHVT0FdFyuVy5N/5vsOFCFRuUlpbG7rvvHr///e83uZ2UoxUbjs788pe/jA4dOmxynS19cOuBBx4Yc+fOjSeeeCLGjx8fjz76aPz617+Oa665JkaNGrXVc6T656NQEWmv45RTTonu3bvHY489FhMmTIhf/vKX8X/+z/+JP//5z9G3b99Kmfeoo46KefPmxV/+8peYMGFC3HvvvfGrX/0q7rzzzjjnnHO2ahvffM3f1Tc/IHiDb/68VbbN/T7a1O8FgMokogB2QI0aNdrkEZFvHoVp3bp1TJw4MY444ogt/sW6devWERExa9asaNOmzRbXKSoqil69em3T3PXq1Ysf/ehH8aMf/SjWrl0bJ554Ytxwww1x9dVXR5MmTaKoqChmzZq1xW20aNEi5s6du9Hyt956q+z+LUl9HXvuuWdceOGFceGFF8bixYvj0EMPjRtuuGGzEdWkSZOoU6fOJk/H29Tcm9K4ceM488wz48wzz4yVK1fGUUcdFSNHjiyLqM1FzbYoLS2N9957r+zoU0TE22+/HRFRdqXHDUd8li5dWu6xmzqNbmtna9KkSdStW3ez+zIvLy+aN2++VdsC2N6czgewA2rdunW89dZb5a7c9/rrr290ie5TTjklSkpK4rrrrttoG+vXry/7S/Fxxx0XhYWFMXr06Fi9enW59Tb8K3/Hjh2jdevWcfPNN8fKlSs32t63XUXwiy++KHc7Pz8/2rZtG1mWxbp16yIvLy/69+8f//3f/x0zZszY6PEb5vhf/+t/xcsvvxzTpk0ru++rr76Ku+++O1q2bBlt27bd4hxb+zpKSko2Oj1x9913j2bNmsWaNWs2u/0aNWpE79694/HHH48PP/ywbPmcOXPi6aef3uJsERt/n+rXrx9t2rQp95z16tWLiI2jZlvdcccdZb/OsizuuOOOqFWrVhxzzDER8Y8wrVGjRjz//PPlHvfrX/96o21t7Ww1atSI4447Lv7yl7+UO23w008/jT/84Q9x5JFHRlFR0Ta+IoDK5UgUwA7orLPOiltvvTV69+4dZ599dixevDjuvPPOOOigg8q9Gb9Hjx5x3nnnxejRo+O1116L4447LmrVqhXvvPNOPPzww/Ef//EfcdJJJ0VRUVH86le/inPOOSc6d+4cp556ajRq1Chef/31WLVqVdx///2Rl5cX9957b/Tt2zcOOuigOPPMM2OvvfaKBQsWxOTJk6OoqCj++7//e7MzH3fccbHHHnvEEUccEU2bNo05c+bEHXfcEf369YvCwsKIiLjxxhtjwoQJ0aNHjzj33HPjwAMPjE8++SQefvjhmDJlSjRs2DCGDx8ef/zjH6Nv374xdOjQaNy4cdx///0xf/78ePTRRyMvb8v/Pri1r2PFihWx9957x0knnRTt27eP+vXrx8SJE2P69Olxyy23bPE5Ro0aFePHj4/u3bvHhRdeGOvXry/7jKxve39T27Zto2fPntGxY8do3LhxzJgxo+wy6xt07NgxIiKGDh0avXv3jho1asS//uu/bnG7m1NQUBDjx4+PwYMHR9euXeOpp56KcePGxc9+9rOy0z0bNGgQJ598ctx+++2Ry+WidevW8cQTT5S9p+6fpcx2/fXXxzPPPBNHHnlkXHjhhVGzZs246667Ys2aNXHTTTdt0+sB2C6q8tKAADubzV3ivF69ehutO2LEiE1e7nprLnGeZVn2u9/9LmvVqlWWn5+fdejQIXv66ac3usT5BnfffXfWsWPHrE6dOllhYWF28MEHZ1dddVW2cOHCcuv99a9/zQ4//PCsTp06WVFRUdalS5fsj3/8Y7l1Zs6cmZ144onZ9773vax27dpZixYtslNOOSWbNGnSFr83d911V3bUUUeVPa5169bZlVdemS1btqzceh988EF2xhlnZE2aNMlq166dtWrVKhsyZEi2Zs2asnXmzZuXnXTSSVnDhg2zgoKCrEuXLtkTTzxRbjsbLsv98MMPb3Keb3sda9asya688sqsffv2WWFhYVavXr2sffv22a9//estvs4Nnnvuuaxjx45Zfn5+1qpVq+zOO+/c7D7/50ucX3/99VmXLl2yhg0bZnXq1MkOOOCA7IYbbsjWrl1bts769euziy++OGvSpEmWy+XKtrnhZ+WXv/zlRvNs7hLn9erVy+bNm5cdd9xxWd26dbOmTZtmI0aMKLtU/AafffZZNnDgwKxu3bpZo0aNsvPOOy+bNWvWRtvc3GxZtvElzrMsy1599dWsd+/eWf369bO6detmRx99dPbiiy+WW2dTv6+ybPOXXgeobLks825MAACAreU9UQAAAAlEFAAAQAIRBQAAkEBEAQAAJBBRAAAACUQUAABAgl3+w3ZLS0tj4cKFUVhYGLlcrqrHAQAAqkiWZbFixYpo1qzZFj+8fZePqIULF0bz5s2regwAAKCa+Oijj2Lvvffe7P27fEQVFhZGxD++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EogoAACABCIKAAAggYgCAABIIKIAAAASiCgAAIAEIgoAACCBiAIAAEggogAAABKIKAAAgAQiCgAAIIGIAgAASLDLRlRxcXG0bds2OnfuXNWjAAAAO5BdNqKGDBkSs2fPjunTp1f1KAAAwA5kl40oAACAbSGiAAAAEogoAACABCIKAAAgwXeOqOXLl8fjjz8ec+bMqYh5AAAAqrXkiDrllFPijjvuiIiIr7/+Ojp16hSnnHJKtGvXLh599NEKHxAAAKA6SY6o559/Prp37x4REY899lhkWRZLly6N//t//29cf/31FT4gAABAdZIcUcuWLYvGjRtHRMT48eNj4MCBUbdu3ejXr1+88847FT4gAABAdZIcUc2bN49p06bFV199FePHj4/jjjsuIiK+/PLLKCgoqPABAQAAqpOaqQ+49NJL47TTTov69etHixYtomfPnhHxj9P8Dj744IqeDwAAoFpJjqgLL7wwunbtGh9++GEce+yxkZf3j4NZrVq1ihtuuKHCBwQAAKhOkk/nu/baa+PAAw+MAQMGRP369cuW//CHP4yJEydW6HAAAADVTXJEjRo1KlauXLnR8lWrVsWoUaMqZCgAAIDqKjmisiyLXC630fLXX3+97Kp9AAAAO6utfk9Uo0aNIpfLRS6Xi/33379cSJWUlMTKlSvj/PPPr5QhAQAAqoutjqjbbrstsiyLs846K0aNGhUNGjQouy8/Pz9atmwZ3bp1q5QhAQAAqoutjqjBgwdHRMS+++4bhx9+eNSqVavShgIAAKiuki9x3qNHjygtLY233347Fi9eHKWlpeXuP+qooypsOAAAgOomOaL+9re/xamnnhoffPBBZFlW7r5cLhclJSUVNlxlKi4ujuLi4h1mXgAAoHpIvjrf+eefH506dYpZs2bFkiVL4ssvvyz7WrJkSWXMWCmGDBkSs2fPjunTp1f1KAAAwA4k+UjUO++8E4888ki0adOmMuYBAACo1pKPRHXt2jXefffdypgFAACg2ks+EnXxxRfH5ZdfHosWLYqDDz54o6v0tWvXrsKGAwAAqG6SI2rgwIEREXHWWWeVLcvlcpFl2Q51YQkAAIBtkRxR8+fPr4w5AAAAdgjJEdWiRYvKmAMAAGCHsFUR9de//jX69u0btWrVir/+9a9bXPeEE06okMEAAACqo62KqP79+8eiRYti9913j/79+292Pe+JAgAAdnZbFVGlpaWb/DUAAMCuJvlzogAAAHZl2xRRzz33XBx//PHRpk2baNOmTZxwwgnxwgsvVPRsAAAA1U5yRP3ud7+LXr16Rd26dWPo0KExdOjQqFOnThxzzDHxhz/8oTJmBAAAqDZyWZZlKQ848MAD49xzz43LLrus3PJbb7017rnnnpgzZ06FDljZli9fHg0aNIhly5ZFUVFRVY8DUOlaDh9X1SOwg3l/TL+qHgFgu9jaNkg+EvXee+/F8ccfv9HyE044wQfxAgAAO73kiGrevHlMmjRpo+UTJ06M5s2bV8hQAAAA1dVWXeL8n11++eUxdOjQeO211+Lwww+PiIipU6fG2LFj4z/+4z8qfEAAAIDqJDmiLrjggthjjz3illtuiT/96U8R8Y/3ST300EPxL//yLxU+IAAAQHWSHFEREQMGDIgBAwZU9CwAAADV3jZFVETEjBkzyq7E17Zt2+jYsWOFDQUAAFBdJUfUxx9/HIMGDYqpU6dGw4YNIyJi6dKlcfjhh8eDDz4Ye++9d0XPCAAAUG0kX53vnHPOiXXr1sWcOXNiyZIlsWTJkpgzZ06UlpbGOeecUxkzAgAAVBvJH7Zbp06dePHFF+OQQw4pt/yVV16J7t27x6pVqyp0wMpSXFwcxcXFUVJSEm+//bYP2wV2GT5sFyqGDyGGnU+lfdhu8+bNY926dRstLykpiWbNmqVursoMGTIkZs+eHdOnT6/qUQAAgB1IckT98pe/jIsvvjhmzJhRtmzGjBlxySWXxM0331yhwwEAAFQ3yafzNWrUKFatWhXr16+PmjX/cV2KDb+uV69euXWXLFlScZNWkq09ZAews3A6H1QMp/PBzmdr2yD56ny33Xbbd5kLAABgh5YcUYMHD66MOQAAAHYIye+JAgAA2JWJKAAAgAQiCgAAIMFWRdQbb7wRpaWllT0LAABAtbdVEXXIIYfE559/HhERrVq1ii+++KJShwIAAKiutiqiGjZsGPPnz4+IiPfff99RKQAAYJe1VZc4HzhwYPTo0SP23HPPyOVy0alTp6hRo8Ym133vvfcqdEAAAIDqZKsi6u67744TTzwx3n333Rg6dGj85Cc/icLCwsqeDQAAoNrZ6g/b7dOnT0REvPLKK3HJJZeIKAAAYJe01RG1wX333Vf2648//jgiIvbee++KmwgAAKAaS/6cqNLS0rj22mujQYMG0aJFi2jRokU0bNgwrrvuOhecAAAAdnrJR6J+/vOfx3/+53/GmDFj4ogjjoiIiClTpsTIkSNj9erVccMNN1T4kAAAANVFckTdf//9ce+998YJJ5xQtqxdu3ax1157xYUXXiiiAACAnVry6XxLliyJAw44YKPlBxxwQCxZsqRChgIAAKiukiOqffv2cccdd2y0/I477oj27dtXyFAAAADVVfLpfDfddFP069cvJk6cGN26dYuIiGnTpsVHH30UTz75ZIUPCAAAUJ0kH4nq0aNHvP322zFgwIBYunRpLF26NE488cSYO3dudO/evTJmBAAAqDaSj0RFRDRr1swFJAAAgF1S8pEoAACAXZmIAgAASCCiAAAAEiRFVJZl8eGHH8bq1asra57tpri4ONq2bRudO3eu6lEAAIAdSHJEtWnTJj766KPKmme7GTJkSMyePTumT59e1aMAAAA7kKSIysvLi/322y+++OKLypoHAACgWkt+T9SYMWPiyiuvjFmzZlXGPAAAANVa8udEnXHGGbFq1apo37595OfnR506dcrdv2TJkgobDgAAoLpJjqjbbrutEsYAAADYMSRH1ODBgytjDgAAgB3CNn1O1Lx58+IXv/hFDBo0KBYvXhwREU899VS8+eabFTocAABAdZMcUc8991wcfPDB8dJLL8Wf//znWLlyZUREvP766zFixIgKHxAAAKA6SY6o4cOHx/XXXx/PPPNM5Ofnly3/4Q9/GH/7298qdDgAAIDqJjmi/v73v8eAAQM2Wr777rvH559/XiFDAQAAVFfJEdWwYcP45JNPNlo+c+bM2GuvvSpkKAAAgOoqOaL+9V//NX7605/GokWLIpfLRWlpaUydOjWuuOKKOOOMMypjRgAAgGojOaJuvPHGOOCAA6J58+axcuXKaNu2bRx11FFx+OGHxy9+8YvKmBEAAKDaSP6cqPz8/Ljnnnvi3//932PWrFmxcuXKOOSQQ2K//farjPkAAACqleSI2mCfffaJ5s2bR0RELpersIEAAACqs236sN3//M//jB/84AdRUFAQBQUF8YMf/CDuvffeip4NAACg2kk+EnXNNdfErbfeGhdffHF069YtIiKmTZsWl112WXz44Ydx7bXXVviQAAAA1UVyRP3mN7+Je+65JwYNGlS27IQTToh27drFxRdfLKIAAICd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lClRWloao0ePjn333Tfq1KkT7du3j0ceeWSzMwJQOUQUAJXqlltuiU6dOsXMmTPjwgsvjAsuuCDmzp0bERGffPJJHHTQQXH55ZfHJ598EldcccU2PccLL7wQZ5xxRlxyySUxe/bsuOuuu2Ls2LFxww03REREaWlp9O3bN6ZOnRq/+93vYvbs2TFmzJioUaNGRPzjaFifPn1i4MCB8cYbb8RDDz0UU6ZMiYsuumizz3naaafF3nvvHdOnT49XXnklhg8fXnYq42uvvRbHHHNMtG3bNqZNmxZTpkyJ448/PkpKSiIi4qqrropHH3007r///nj11VejTZs20bt371iyZEm55xg+fHiMGTMm5syZE+3atYvRo0fHf/3Xf8Wdd94Zb775Zlx22WXxb//2b/Hcc89t0/cNgG2UAUAF6dGjR3bJJZeU3W7RokX2b//2b2W3S0tLs9133z37zW9+U7asffv22YgRI8puz58/P4uIbObMmVmWZdl9992XNWjQoNzzPPbYY9k//xF2zDHHZDfeeGO5dR544IFszz33zLIsy55++uksLy8vmzt37ibnPvvss7Nzzz233LIXXnghy8vLy77++utNPqawsDAbO3bsJu8bNGhQdsQRR2zyvpUrV2a1atXKfv/735ctW7t2bdasWbPspptuyrIsyyZPnpxFRPb444+XrbN69eqsbt262YsvvrjR7IMGDdrkcwFQOZxcDUClateuXdmvc7lc7LHHHrF48eIKfY7XX389pk6dWnbkKSKipKQkVq9eHatWrYrXXnst9t5779h///03+/g33ngjfv/735cty7IsSktLY/78+XHggQdu9Jhhw4bFOeecEw888ED06tUrTj755GjdunVE/ONI1Mknn7zJ55o3b16sW7cujjjiiLJltWrVii5dusScOXPKrdupU6eyX7/77ruxatWqOPbYY8uts3bt2jjkkEM2960BoBKIKAAq1Tev1pfL5aK0tHSrH5+XlxdZlpVbtm7dunK3V65cGaNGjYoTTzxxo8cXFBREnTp1tvgcK1eujPPOOy+GDh260X377LPPJh8zcuTIOPXUU2PcuHHx1FNPxYgRI+LBBx+MAQMGfOvzba169eqVmzEiYty4cbHXXnuVW6927doV8nwAbB0RBUC11qRJk1ixYkV89dVXZVHxzc+QOvTQQ2Pu3LnRpk2bTW6jXbt28fHHH8fbb7+9yaNRhx56aMyePXuzj9+c/fffP/bff/+47LLLYtCgQXHffffFgAEDol27djFp0qQYNWrURo9p3bp15Ofnx9SpU8uuSLhu3bqYPn36Fj9jq23btlG7du348MMPo0ePHklzAlCxRBQA1VrXrl2jbt268bOf/SyGDh0aL730UowdO7bcOtdcc0387//9v2OfffaJk046KfLy8uL111+PWbNmxfXXXx89evSIo446KgYOHBi33nprtGnTJt56663I5XLRp0+f+OlPfxqHHXZYXHTRRXHOOedEvXr1Yvbs2fHMM8/EHXfcsdFMX3/9dVx55ZVx0kknxb777hsff/xxTJ8+PQYOHBgREVdffXUcfPDBceGFF8b5558f+fn5MXny5Dj55JNjt912iwsuuCCuvPLKaNy4ceyzzz5x0003xapVq+Lss8/e7PehsLAwrrjiirjsssuitLQ0jjzyyFi2bFlMnTo1ioqKYvDgwRX6fQdg81ydD4BqrXHjxvG73/0unnzyyTj44IPjj3/840aXQu/du3c88cQTMWHChOjcuXMcdthh8atf/arsSE9ExKOPPhqdO3eOQYMGRdu2beOqq64qu1peu3bt4rnnnou33347unfvHoccckhcc8010axZs03OVKNGjfjiiy/ijDPOiP333z9OOeWU6Nu3b9mRp/333z8mTJgQr7/+enTp0iW6desWf/nLX8o+52nMmDExcODAOP300+PQQw+Nd999N55++ulo1KjRFr8X1113Xfz7v/97jB49Og488MDo06dPjBs3Lvbdd99t/fYCsA1y2TdPNAcAAGCzHIkCAABIIKIAAAASiCgAAIAEIgoAACCBiAIAAEggogAAABKIKAAAgAQiCgAAIIGIAgAASCCiAAAAEogoAACABP8PRcg0v1tW2nQAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 1000x700 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure(figsize=(10, 7))\n",
    "plt.hist(mean_train_influences, log=True)\n",
    "plt.title(\"Influece scores distribution\")\n",
    "plt.xlabel(\"influece score\")\n",
    "plt.ylabel(\"number of points\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cc27f78c",
   "metadata": {},
   "source": [
    "# Conjugate Gradient and beyond in PyDVL"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9245791c",
   "metadata": {},
   "source": [
    "This was a quick introduction to influence functions and how they could help you in your projects. Give it a try! For example you can try with a bigger neural network and using conjugate gradient for the calculation of influence functions. This can me done in the following way "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "450acac2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-27T15:50:22.934410Z",
     "iopub.status.busy": "2022-09-27T15:50:22.933982Z",
     "iopub.status.idle": "2022-09-27T15:50:26.781248Z",
     "shell.execute_reply": "2022-09-27T15:50:26.779903Z"
    }
   },
   "outputs": [],
   "source": [
    "train_influences = influences(\n",
    "    nn,\n",
    "    F.cross_entropy,\n",
    "    *train_ds,\n",
    "    *test_ds,\n",
    "    inversion_method=\"cg\",\n",
    "    inversion_method_kwargs={\"max_iterations\": 10, \"max_step_size\": 0.01}\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e802d2d3",
   "metadata": {},
   "source": [
    "where max_iterations and max_step_size and yet another set of hyperparameters that need to be tuned to obtain a good estimate."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4d563f8e",
   "metadata": {},
   "source": [
    "Finally, despite their speed and simplicity, influence functions are known to be a very noisy estimator of data quality, as pointed out in the paper [\"Influence functions in deep learning are fragile\"](https://arxiv.org/abs/2006.14651). The size of the network, the weight decay, the inversion method used for calculating influences, the size of the test set: they all add up to the total amount of noise in the influence values. Experiments may therefore give quantitative and qualitative different results if not averaged across several realisations. Shapley values, on the contrary, have shown to be a more robust, but this comes at the cost of high computational requirements. PyDVL employs several parallelization and caching techniques to optimize such calculations."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.4"
  },
  "vscode": {
   "interpreter": {
    "hash": "4e000971326892723e7f31ded70802f690c31c3620f59a0f99e594aaee3047ef"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}

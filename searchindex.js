Search.setIndex({"docnames": ["examples/index", "examples/influence_synthetic", "examples/influence_wine", "examples/knn_shapley_flowers", "examples/shapley_spotify", "getting-started", "index", "install", "valuation/index", "valuation/influence", "valuation/influence/cg", "valuation/influence/frameworks", "valuation/influence/frameworks/torch_differentiable", "valuation/influence/general", "valuation/influence/linear", "valuation/influence/model_wrappers", "valuation/influence/model_wrappers/torch_wrappers", "valuation/influence/types", "valuation/loo", "valuation/loo/naive", "valuation/reporting", "valuation/reporting/plots", "valuation/reporting/scores", "valuation/shapley", "valuation/shapley/actor", "valuation/shapley/knn", "valuation/shapley/montecarlo", "valuation/shapley/naive", "valuation/utils", "valuation/utils/caching", "valuation/utils/config", "valuation/utils/dataset", "valuation/utils/numeric", "valuation/utils/parallel", "valuation/utils/parallel/actor", "valuation/utils/parallel/backend", "valuation/utils/parallel/map_reduce", "valuation/utils/plotting", "valuation/utils/progress", "valuation/utils/types", "valuation/utils/utility"], "filenames": ["examples/index.rst", "examples/influence_synthetic.ipynb", "examples/influence_wine.ipynb", "examples/knn_shapley_flowers.ipynb", "examples/shapley_spotify.ipynb", "getting-started.rst", "index.rst", "install.rst", "valuation/index.rst", "valuation/influence.rst", "valuation/influence/cg.rst", "valuation/influence/frameworks.rst", "valuation/influence/frameworks/torch_differentiable.rst", "valuation/influence/general.rst", "valuation/influence/linear.rst", "valuation/influence/model_wrappers.rst", "valuation/influence/model_wrappers/torch_wrappers.rst", "valuation/influence/types.rst", "valuation/loo.rst", "valuation/loo/naive.rst", "valuation/reporting.rst", "valuation/reporting/plots.rst", "valuation/reporting/scores.rst", "valuation/shapley.rst", "valuation/shapley/actor.rst", "valuation/shapley/knn.rst", "valuation/shapley/montecarlo.rst", "valuation/shapley/naive.rst", "valuation/utils.rst", "valuation/utils/caching.rst", "valuation/utils/config.rst", "valuation/utils/dataset.rst", "valuation/utils/numeric.rst", "valuation/utils/parallel.rst", "valuation/utils/parallel/actor.rst", "valuation/utils/parallel/backend.rst", "valuation/utils/parallel/map_reduce.rst", "valuation/utils/plotting.rst", "valuation/utils/progress.rst", "valuation/utils/types.rst", "valuation/utils/utility.rst"], "titles": ["Examples", "Influence functions for data mislabeling", "Clean dataset using influence functions and neural networks", "KNN Shapley", "PyDVL - Shapley for data valuation", "Getting started", "pyDVL Documentation", "Installing pyDVL", "valuation", "influence", "cg", "frameworks", "torch_differentiable", "general", "linear", "model_wrappers", "torch_wrappers", "types", "loo", "naive", "reporting", "plots", "scores", "shapley", "actor", "knn", "montecarlo", "naive", "utils", "caching", "config", "dataset", "numeric", "parallel", "actor", "backend", "map_reduce", "plotting", "progress", "types", "utility"], "terms": {"influenc": [0, 6, 7, 8, 13, 14, 37], "function": [0, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 19, 23, 26, 27, 29, 31, 32, 36], "data": [0, 3, 5, 6, 13, 14, 19, 21, 22, 23, 25, 26, 27, 29, 31, 36, 37, 40], "mislabel": [0, 6], "plot": [0, 2, 3, 4, 5, 6, 8, 20, 23, 26, 28], "dataset": [0, 3, 4, 6, 8, 22, 23, 25, 26, 28, 32, 37, 40], "train": [0, 2, 3, 4, 5, 6, 13, 14, 15, 16, 22, 23, 27, 29, 30, 31, 37], "model": [0, 2, 3, 4, 5, 6, 11, 12, 13, 14, 15, 16, 19, 22, 23, 25, 26, 27, 29, 30, 37, 40], "calcul": [0, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15, 16, 17, 23, 26, 29, 30, 31, 32, 34], "appendix": [0, 6], "decis": [0, 6, 32, 37], "boundari": [0, 6, 32, 37], "clean": [0, 4, 6], "us": [0, 1, 3, 4, 6, 7, 10, 13, 14, 15, 16, 21, 23, 25, 26, 27, 29, 30, 31, 34, 36, 37, 40], "neural": [0, 6, 15, 16], "network": [0, 6, 15, 16], "fit": [0, 1, 4, 5, 6, 22, 39], "small": [0, 5, 6, 29, 30], "conjug": [0, 1, 5, 6, 10, 13], "gradient": [0, 1, 5, 6, 10, 11, 12, 13, 17], "beyond": [0, 6], "pydvl": [0, 1, 3, 5], "knn": [0, 6, 8, 23], "shaplei": [0, 2, 6, 8, 22, 25, 26, 27, 30, 31, 32, 34, 37], "corrupt": [0, 1, 4, 6], "label": [0, 1, 2, 4, 6, 31, 34, 37], "valuat": [0, 1, 2, 3, 5, 6, 7, 30, 32, 34, 35, 36], "evalu": [0, 6], "anomal": [0, 3, 6], "In": [1, 3, 4, 5, 7, 29, 30], "thi": [1, 2, 3, 4, 5, 6, 7, 29, 31, 32], "notebook": [1, 2, 3, 4], "we": [1, 2, 3, 4, 5, 6, 23, 26, 30, 36], "take": [1, 2, 3, 4, 5, 6, 29, 30, 32, 36], "closer": [1, 5], "look": [1, 2, 4, 5], "theori": 1, "help": [1, 2, 4], "synthet": 1, "occur": 1, "whenev": 1, "some": [1, 2, 3, 4], "exampl": [1, 2, 5, 6, 21, 34, 35, 36], "from": [1, 2, 3, 4, 5, 7, 10, 13, 21, 22, 23, 25, 26, 31, 32, 34, 35, 36, 37], "usual": [1, 21], "big": [1, 2], "ar": [1, 2, 3, 4, 5, 13, 14, 16, 21, 29, 30, 31, 32, 36], "wrongli": 1, "real": [1, 5, 30], "life": 1, "happen": [1, 4, 22], "fairli": 1, "often": 1, "e": [1, 2, 3, 21, 23, 26, 29, 32, 36, 37], "g": [1, 2, 23, 26, 32, 36, 37], "consequ": 1, "human": 1, "error": [1, 2, 4, 5, 10, 23, 26, 29], "nois": [1, 2], "let": [1, 2, 3, 4], "s": [1, 2, 3, 4, 6, 21, 23, 26, 32, 37], "consid": 1, "classif": [1, 2], "problem": [1, 2, 5], "follow": [1, 2, 4, 5, 7], "notat": 1, "begin": 1, "align": 1, "x_i": [1, 11, 12, 15, 16], "mathbb": 1, "r": [1, 10, 36], "d": 1, "y_i": [1, 11, 12, 15, 16], "0": [1, 2, 3, 4, 5, 10, 21, 22, 29, 30, 31, 32, 36, 40], "1": [1, 2, 3, 4, 10, 15, 16, 21, 23, 26, 29, 30, 32, 36], "foral": 1, "i": [1, 2, 3, 4, 13, 15, 16, 17, 21, 29, 32], "n": [1, 13, 14, 15, 16, 32, 37], "end": 1, "other": [1, 4, 23, 25, 27, 29, 32], "word": [1, 29], "have": [1, 2, 3, 4, 5, 29, 30, 34, 37], "contain": [1, 5, 9, 10, 12, 13, 14, 15, 16, 32], "sampl": [1, 3, 5, 23, 26, 31, 32], "each": [1, 2, 3, 4, 5, 14, 21, 22, 23, 26, 29, 31, 32, 36, 37], "As": [1, 3, 4], "typic": [1, 4, 31], "you": [1, 2, 4, 5, 6, 7, 30, 32], "can": [1, 2, 3, 4, 5, 7, 13, 30, 31, 32], "think": 1, "y": [1, 2, 5, 11, 12, 14, 15, 16, 17, 31, 32, 37, 39], "indic": [1, 3, 22, 23, 26, 31, 34, 37], "whether": [1, 23, 25, 32, 34], "patient": 1, "ha": [1, 2, 3, 4, 10, 23, 26, 29, 30, 34], "diseas": 1, "base": [1, 11, 12, 13, 15, 16, 17, 29, 30, 31, 34, 36, 39, 40], "featur": [1, 4, 5, 7, 11, 12, 13, 14, 15, 16, 31, 37], "represent": 1, "x": [1, 5, 11, 12, 15, 16, 17, 21, 29, 32, 34, 37, 39], "now": [1, 2, 3, 4, 30], "introduc": [1, 4], "toi": 1, "delv": 1, "practic": [1, 4], "util": [1, 2, 3, 4, 6, 8, 19, 23, 26, 27, 30, 32, 34, 35, 36], "assum": [1, 14, 32], "bernoulli": 1, "binari": [1, 15, 16], "random": [1, 30, 31, 32], "variabl": 1, "while": [1, 2, 4], "input": [1, 2, 4, 15, 16, 17, 29, 36, 37], "dimension": [1, 37], "gaussian": 1, "distribut": [1, 2, 3, 23, 26, 29, 32], "which": [1, 2, 3, 4, 5, 10, 13, 14, 23, 26, 29, 34, 38], "depend": [1, 6, 30], "more": [1, 2, 3, 4, 5, 10, 29, 30, 31], "precis": [1, 4, 29, 30], "sim": 1, "text": [1, 2], "ber": 1, "left": [1, 7], "5": [1, 2, 3, 4, 5, 23, 26, 34, 36], "right": 1, "mathcal": 1, "mu_1": 1, "mu_2": 1, "sigma": 1, "2": [1, 2, 3, 4, 5, 10, 15, 16, 32, 36, 37], "fix": [1, 31], "mean": [1, 2, 3, 4, 5, 21, 29], "diagon": 1, "covari": 1, "implement": [1, 3, 4, 10, 19, 22, 23, 26], "scheme": 1, "python": [1, 7], "straightforward": 1, "achiev": [1, 30], "first": [1, 2, 4, 6, 13, 23, 26], "afterward": 1, "The": [1, 2, 3, 4, 5, 10, 21, 23, 25, 29, 30, 37], "code": [1, 32], "snippet": 1, "gener": [1, 2, 3, 5, 8, 9, 32, 36], "aforement": 1, "15": [1, 4], "import": [1, 2, 3, 4, 5, 7, 13, 29, 32, 34, 35, 36], "numpi": [1, 2, 3, 5, 7, 36], "np": [1, 2, 3, 5, 11, 12, 13, 14, 22, 32, 36], "model_wrapp": [1, 2, 8, 9], "torchbinarylogisticregress": [1, 15, 16], "torch": [1, 2, 11, 12, 13], "nn": [1, 2, 11, 12, 13], "f": [1, 2, 3, 10, 11, 12, 15, 16, 32], "matplotlib": [1, 2, 3, 4, 7, 21], "pyplot": [1, 2, 3], "plt": [1, 2, 3, 21], "optim": [1, 2, 5, 15, 16, 37], "adamw": 1, "lr_schedul": [1, 2], "synthetic_classification_dataset": 1, "sklearn": [1, 2, 3, 4, 5, 22, 31], "metric": [1, 2, 4], "confusion_matrix": [1, 2], "confusionmatrixdisplai": [1, 2], "plot_dataset": [1, 37], "plot_influ": [1, 37], "num_sampl": 1, "10000": 1, "num_featur": 1, "asarrai": 1, "num_class": [1, 2], "len": [1, 2, 3, 31], "train_d": [1, 2, 37], "val_d": [1, 2], "test_d": [1, 2, 37], "train_siz": [1, 2, 31], "7": [1, 2, 3, 4], "test_siz": [1, 2, 4, 5, 31], "given": [1, 2, 4, 23, 26, 29, 31], "simplic": [1, 2], "exactli": 1, "maxim": 1, "our": [1, 2, 4], "accuraci": [1, 2, 34], "map": [1, 22, 36, 37], "continu": 1, "line": [1, 37], "z": 1, "valu": [1, 2, 3, 4, 6, 11, 12, 13, 21, 22, 23, 25, 26, 27, 29, 30, 31, 32, 34, 37], "vector": [1, 5, 10, 11, 12, 17, 32], "space": [1, 3, 5], "detail": [1, 2, 4, 5, 10], "16": [1, 2, 4, 5], "decision_boundary_fixed_variance_2d": 1, "decision_boundary_fn": 1, "decision_boundari": 1, "linspac": 1, "100": [1, 4, 5], "respect": [1, 3, 5, 10, 11, 12, 13, 14, 17, 32], "17": 1, "test": [1, 2, 4, 5, 7, 13, 14, 16, 22, 23, 27, 31, 37], "x_min": [1, 37], "x_max": [1, 37], "3": [1, 2, 3, 4, 7, 29, 30, 31, 36], "xlabel": [1, 2, 4, 37], "x_0": 1, "ylabel": [1, 2, 4, 37], "x_1": 1, "legend_titl": [1, 3, 37], "10": [1, 2, 3, 4, 10, 23, 26, 27, 36, 37], "suptitl": [1, 3, 37], "note": [1, 16, 37], "go": [1, 4, 5, 6, 7, 30], "across": [1, 2, 23, 26, 36], "discrimin": 1, "presenc": 1, "logist": [1, 15, 16], "regress": [1, 5, 14, 15, 16, 32], "done": [1, 2, 3, 5], "18": [1, 4, 37], "devic": [1, 2], "cuda": [1, 2], "is_avail": [1, 2], "els": [1, 2], "cpu": [1, 2, 30, 35, 36], "num_epoch": [1, 2], "50": [1, 5], "lr": [1, 2], "05": 1, "weight_decai": [1, 2], "batch_siz": [1, 2], "128": 1, "param": [1, 2, 11, 12, 15, 16, 31, 37], "paramet": [1, 2, 5, 10, 11, 12, 13, 14, 17, 19, 21, 22, 23, 25, 26, 27, 29, 30, 31, 32, 34, 35, 36, 37, 38], "schedul": [1, 2], "cosineannealinglr": [1, 2], "t_max": [1, 2], "train_loss": [1, 2], "val_loss": [1, 2], "x_train": [1, 2, 4, 5, 13, 14, 31, 37], "y_train": [1, 2, 3, 4, 5, 13, 14, 31], "astyp": 1, "float": [1, 10, 19, 21, 22, 23, 26, 27, 29, 30, 31, 37, 39, 40], "x_val": [1, 2], "y_val": [1, 2], "loss": [1, 2, 5, 11, 12, 13, 17], "binary_cross_entropi": 1, "And": [1, 2, 4], "check": [1, 2, 7, 10, 23, 26, 32, 34], "overfit": 1, "32": 1, "figur": [1, 2, 4, 37], "figsiz": [1, 2, 4, 37], "val": [1, 2], "legend": [1, 2], "show": [1, 2, 3, 4], "A": [1, 10, 11, 12, 13, 14, 15, 16, 29, 32, 34, 36, 37, 40], "confus": [1, 2], "matrix": [1, 2, 6, 10, 11, 12, 21], "also": [1, 2, 4, 7, 10, 37], "good": [1, 2], "result": [1, 2, 4, 5, 10, 21, 29, 34, 36, 40], "20": [1, 4, 23, 27, 36, 37], "pred_prob": 1, "detach": [1, 2], "pred_y_test": [1, 2], "prob": 1, "cm": [1, 2], "disp": [1, 2], "lt": [1, 2], "_plot": [1, 2], "0x7f8e5d2e56f0": 1, "gt": [1, 2], "It": [1, 2, 5, 10, 15, 16, 32, 34, 36], "converg": [1, 4], "point": [1, 2, 3, 4, 13, 14, 22, 23, 26, 31, 37], "optimum": 1, "sinc": [1, 2, 4, 23, 27, 30], "minimum": [1, 2, 29, 30, 31, 37], "close": [1, 14], "landscap": 1, "y_1": 1, "x_2": 1, "y_2": 1, "colon": 1, "time": [1, 3, 6, 10, 29, 30, 34, 36], "measur": 1, "onto": [1, 14], "condit": 1, "target": [1, 10, 11, 12, 13, 14, 31], "trough": 1, "theta": 1, "If": [1, 2, 3, 4, 5, 6, 13, 19, 23, 26, 29, 30, 31, 34, 36], "l": [1, 32], "differenti": [1, 11, 12], "nabla_": 1, "mathsf": 1, "t": [1, 4, 10, 32, 36], "h_": 1, "see": [1, 3, 4, 5, 10, 32], "understand": 1, "black": 1, "box": 1, "predict": [1, 2, 4, 11, 12, 39], "via": 1, "deriv": [1, 5, 11, 12, 32], "formula": 1, "subset": [1, 4, 31, 32, 37], "21": [1, 4], "22": [1, 3, 4], "influence_valu": 1, "x_test": [1, 4, 5, 13, 14, 31], "y_test": [1, 4, 5, 13, 14, 31], "influence_typ": [1, 5, 13, 14], "up": [1, 2, 4, 5, 13, 14, 30], "inversion_method": [1, 2, 5, 13], "direct": [1, 2, 6, 10, 13], "cg": [1, 2, 5, 8, 9, 13], "abov": [1, 3, 4, 30], "explicitli": [1, 16], "construct": [1, 5, 13, 31], "hessian": [1, 2, 5, 11, 12, 13, 17, 32], "computation": [1, 4], "expens": [1, 4, 23, 27], "approxim": [1, 4, 6, 10, 23, 26], "should": [1, 2, 4, 5, 7, 10, 11, 12, 34], "bigger": [1, 2], "With": 1, "type": [1, 3, 5, 8, 9, 13, 28, 30], "shape": [1, 2, 10, 13, 14, 15, 16, 32, 37], "nxm": [1, 13, 14, 32], "where": [1, 2, 5, 13, 32, 37], "number": [1, 2, 5, 10, 11, 12, 13, 21, 23, 26, 29, 30, 31, 32, 34, 35, 36, 37], "m": [1, 10, 13, 32], "thei": [1, 2, 3, 4, 16], "therefor": [1, 2], "associ": [1, 31], "its": [1, 4, 30], "perturb": [1, 6, 13, 14], "instead": [1, 4, 10, 23, 26, 29, 30, 36], "return": [1, 2, 4, 10, 11, 12, 13, 14, 15, 16, 22, 23, 26, 27, 29, 30, 31, 32, 34, 35, 37, 38], "an": [1, 2, 3, 4, 5, 10, 21, 23, 26, 31, 32, 35, 36, 37], "arrai": [1, 3, 34, 37], "nxmxf": 1, "ie": 1, "length": [1, 3, 23, 27], "case": [1, 4, 5, 23, 27, 30], "order": [1, 4, 5, 7, 23, 26, 29, 32], "total": [1, 2, 4, 23, 26, 34, 37], "averag": [1, 2, 3, 13, 23, 26, 29, 30, 32, 34], "just": [1, 4, 30], "23": [1, 4], "mean_train_influ": [1, 2], "axi": [1, 2, 4, 21], "24": [1, 4, 31], "colorbar_limit": [1, 3, 37], "approach": [1, 5], "separ": [1, 4, 37], "tend": [1, 3, 4], "move": [1, 2, 4, 23, 26], "awai": 1, "zero": 1, "becom": [1, 23, 27], "posit": [1, 3, 10, 22, 31], "wai": [1, 2, 5], "neg": [1, 4, 14], "further": [1, 5], "how": [1, 2, 3, 4], "chang": [1, 3, 4], "flip": 1, "25": [1, 4], "y_corrupt": 1, "copi": [1, 3, 4], "yi": 1, "26": [1, 4], "print": [1, 3, 7, 11, 12, 23, 27], "correct": 1, "4771455733701123": 1, "004410349344254106": 1, "27": [1, 4], "corrupted_indic": [1, 3, 37], "rang": [1, 3], "red": [1, 3], "circl": [1, 3], "been": 1, "especi": 1, "those": [1, 31], "farther": 1, "For": [1, 2, 3, 4, 5, 21, 30], "obtain": [1, 2], "one": [1, 2, 4, 5, 13, 16, 19, 31, 36], "solv": 1, "equat": 1, "p": [1, 5, 15, 16], "determin": [1, 30], "solut": [1, 10, 14], "set": [1, 2, 4, 13, 14, 21, 22, 23, 26, 27, 29, 30, 31, 32, 34, 36, 37, 38], "probabl": [1, 15, 16], "singl": [1, 4, 30], "varianc": [1, 29], "parameter": 1, "lai": 1, "equidist": 1, "two": [1, 5, 34, 36, 37], "impli": 1, "frac": 1, "implicit": 1, "descript": [1, 31], "explicit": [1, 4, 13], "form": [1, 14], "enforc": 1, "b": [1, 10, 14, 15, 16, 32], "after": [1, 4, 22, 29, 32, 34], "term": 1, "insert": 1, "previou": [1, 5], "az": 1, "write": 1, "symmetri": 1, "expect": [1, 3, 4, 23, 26], "orthogon": 1, "Then": [1, 4], "found": [1, 2, 3, 23, 26, 31], "underbrac": 1, "bmatrix": 1, "_a": 1, "_b": 1, "arbitrari": [2, 5], "wine": 2, "13": 2, "differ": [2, 13, 30, 31, 34], "regard": 2, "particular": 2, "bottl": 2, "relat": [2, 4, 23, 26, 31, 32], "physic": 2, "properti": [2, 31, 32, 36, 38, 40], "concentr": 2, "magnesium": 2, "malic": 2, "acid": 2, "alcohol": 2, "percentag": 2, "etc": [2, 35, 36], "need": [2, 3, 4, 5, 30], "class": [2, 3, 4, 5, 10, 11, 12, 13, 15, 16, 17, 29, 30, 31, 34, 36, 39, 40], "belong": 2, "pleas": [2, 3, 23, 27], "refer": [2, 4, 5, 6, 23, 27, 31], "document": [2, 4, 5, 7], "start": [2, 3, 4, 6, 7, 21, 23, 26, 30, 34, 36], "load": [2, 3, 4, 31], "split": [2, 5, 22, 23, 25, 31, 36, 37], "valid": [2, 4, 14, 31], "larg": [2, 32], "less": [2, 3, 13, 14], "noisi": [2, 4, 29, 30], "estim": [2, 4], "load_wine_dataset": [2, 31], "torchneuralnetwork": [2, 15, 16], "adam": 2, "f1_score": 2, "6": [2, 3, 4], "layer": [2, 15, 16], "conveni": [2, 5, 40], "wrapper": [2, 5, 40], "initi": [2, 31, 35], "pytorch": [2, 7, 11, 12, 13], "alreadi": [2, 4, 23, 26, 31], "skip": 2, "section": [2, 5, 7], "feature_dimens": 2, "unique_class": 2, "uniqu": [2, 3], "concaten": 2, "network_s": 2, "300": [2, 36], "005": 2, "01": 2, "cross_entropi": 2, "stabl": [2, 3], "4": [2, 3, 4], "argmax": 2, "0x7fa8b8da6700": 2, "comput": [2, 3, 4, 6, 19, 21, 22, 23, 25, 26, 27, 29, 30, 32], "f1": 2, "score": [2, 3, 4, 5, 8, 19, 20, 23, 26, 27, 29, 30, 39, 40], "weight": [2, 5, 23, 26, 30, 32], "9720579357550395": 2, "cell": [2, 3, 4], "necessari": [2, 10], "quit": [2, 4], "numer": [2, 8, 10, 28], "challeng": 2, "techniqu": [2, 4], "speed": [2, 4, 5, 30], "allow": [2, 29], "full": [2, 4, 5, 31], "method": [2, 3, 4, 5, 13, 23, 27, 31, 32, 38], "onli": [2, 5, 10, 13, 21, 23, 26, 30, 31, 39], "veri": [2, 4, 30, 32], "like": [2, 4, 32], "current": [2, 4, 13, 14, 23, 26], "ones": [2, 3], "advis": 2, "train_influ": [2, 37], "quantiti": 2, "column": [2, 4, 31], "equal": [2, 31, 34], "row": [2, 32, 37], "At": 2, "element": [2, 23, 26, 31, 37], "a_": 2, "j": [2, 13], "store": [2, 4, 5, 30], "everi": [2, 15, 16, 30], "overal": 2, "histogram": 2, "within": [2, 31], "notic": [2, 3, 4, 31], "log": 2, "scale": 2, "8": [2, 3, 4, 7, 10, 31, 37], "hist": 2, "true": [2, 4, 10, 11, 12, 13, 15, 16, 19, 23, 25, 26, 27, 29, 30, 32, 34, 36, 38, 40], "titl": [2, 4, 37], "influec": 2, "39": 2, "wa": [2, 4, 29], "quick": 2, "introduct": 2, "could": [2, 16], "your": [2, 4, 5, 30], "project": 2, "give": [2, 4], "try": 2, "me": 2, "9": [2, 3, 4, 36], "inversion_method_kwarg": [2, 13], "max_iter": [2, 4, 5, 10, 21, 23, 26], "max_step_s": [2, 10], "yet": [2, 34], "anoth": [2, 4], "hyperparamet": 2, "tune": 2, "final": [2, 4], "despit": 2, "known": 2, "qualiti": 2, "out": [2, 6, 7, 19], "paper": [2, 3], "deep": [2, 4], "learn": [2, 7, 12, 30], "fragil": 2, "size": [2, 10, 31, 32, 37], "decai": 2, "invers": [2, 6, 13], "all": [2, 3, 4, 5, 7, 11, 12, 13, 14, 16, 17, 23, 26, 27, 31, 32, 36], "add": [2, 23, 26], "amount": [2, 36], "experi": 2, "mai": [2, 4, 30], "quantit": 2, "qualit": 2, "sever": [2, 4], "realis": 2, "contrari": 2, "shown": 2, "robust": 2, "come": 2, "cost": 2, "high": [2, 3, 4, 13], "requir": [2, 5, 7], "emploi": 2, "parallel": [2, 4, 8, 13, 19, 22, 28, 30, 32, 34, 35, 36], "cach": [2, 4, 5, 8, 19, 28, 30, 31, 40], "algorithm": [3, 10, 13, 14], "compar": [3, 4], "exponenti": 3, "complex": 3, "linear": [3, 6, 8, 9, 10, 15, 16, 32], "explain": 3, "main": [3, 4, 34], "librari": [3, 4, 5, 6], "os": 3, "sy": 3, "pathlib": 3, "path": 3, "neighbor": 3, "kneighborsclassifi": [3, 23, 25], "plot_iri": [3, 37], "knn_shaplei": [3, 23, 25], "user": [3, 5, 6], "fabio": 3, "miniconda3": 3, "env": 3, "data_shaplei": 3, "lib": 3, "python3": 3, "site": 3, "packag": 3, "tqdm": [3, 7, 23, 26, 27, 38], "auto": [3, 23, 26], "py": [3, 4, 10, 34], "tqdmwarn": 3, "iprogress": 3, "updat": [3, 23, 26, 29, 30], "jupyt": 3, "ipywidget": 3, "http": [3, 7, 10, 31, 34], "readthedoc": 3, "io": 3, "en": [3, 10], "user_instal": 3, "html": 3, "autonotebook": 3, "notebook_tqdm": 3, "through": [3, 4, 6, 15, 16, 30], "iri": [3, 37], "info": [3, 31], "dedic": 3, "page": [3, 6], "sklearn_dataset": 3, "load_iri": 3, "from_sklearn": [3, 31], "next": [3, 4, 6, 34], "n_neighbor": 3, "shapley_valu": 3, "k": [3, 10, 15, 16, 32], "30it": 3, "00": 3, "3708": 3, "27it": 3, "petal": 3, "sepal": 3, "flower": 3, "legend_label": [3, 37], "list": [3, 4, 15, 16, 21, 22, 31, 32, 36, 37], "target_nam": [3, 31], "none": [3, 10, 13, 15, 16, 21, 23, 24, 26, 29, 30, 31, 32, 35, 36, 37, 40], "both": 3, "low": [3, 4, 13, 14], "becaus": [3, 4, 5, 15, 16], "accur": 3, "inform": [3, 4], "class_id": 3, "class_idx": 3, "enumer": [3, 5], "color": [3, 21, 37], "non": [3, 4, 30], "deepcopi": 3, "corrupted_dataset": 3, "contaminated_shaplei": 3, "4361": 3, "49it": 3, "much": [3, 30], "lower": 3, "valuabl": [3, 14], "corrupted_shapley_valu": 3, "idx": 3, "0060392220185388045": 3, "correct_shapley_valu": 3, "regular": 3, "011729071554292213": 3, "confirm": 3, "025": 3, "027": 3, "regardless": 3, "assign": 3, "advantag": 4, "popular": [4, 31], "song": [4, 31], "top": [4, 10, 29], "hit": [4, 29], "spotifi": [4, 31], "2000": 4, "2019": 4, "do": [4, 29], "so": [4, 23, 26, 34], "highlight": 4, "boost": 4, "perform": [4, 15, 16, 30], "here": [4, 5, 21, 39], "entri": 4, "briefli": 4, "describ": 4, "42": 4, "load_ext": 4, "autoreload": 4, "extens": 4, "To": [4, 6, 7], "reload": 4, "reload_ext": 4, "load_spotify_dataset": [4, 31], "intern": [4, 5, 23, 27], "publish": 4, "2014": [4, 31], "30": [4, 34], "remain": 4, "x_input": 4, "y_label": 4, "train_data": 4, "val_data": 4, "test_data": 4, "val_siz": [4, 31], "target_column": [4, 31], "head": 4, "artist": 4, "duration_m": 4, "year": [4, 31], "danceabl": 4, "energi": 4, "kei": [4, 5, 21, 22, 29, 30], "loud": 4, "mode": 4, "speechi": 4, "acoust": 4, "instrument": 4, "live": 4, "valenc": 4, "tempo": 4, "genr": 4, "1561": 4, "fetti": 4, "wap": 4, "679": 4, "feat": 4, "remi": 4, "boyz": 4, "196693": 4, "2015": 4, "618": 4, "717": 4, "738": 4, "3180": 4, "00256": 4, "000000": 4, "6250": 4, "603": 4, "190": 4, "050": 4, "1410": 4, "meghan": 4, "trainor": 4, "about": 4, "That": 4, "bass": 4, "187920": 4, "807": 4, "887": 4, "726": 4, "0503": 4, "05730": 4, "000003": 4, "1240": 4, "961": 4, "134": 4, "052": 4, "14": 4, "1772": 4, "kati": 4, "perri": 4, "chain": 4, "rhythm": 4, "237733": 4, "fals": [4, 10, 11, 12, 13, 17, 23, 26, 29, 30, 31, 34, 36, 38], "2017": 4, "562": 4, "800": 4, "404": 4, "1120": 4, "08140": 4, "1990": 4, "471": 4, "95": 4, "029": 4, "1670": 4, "sigala": 4, "sweet": 4, "lovin": 4, "radio": 4, "edit": 4, "202149": 4, "683": 4, "910": 4, "231": 4, "0515": 4, "05530": 4, "000005": 4, "3360": 4, "674": 4, "124": 4, "977": 4, "1780": 4, "liam": 4, "payn": 4, "strip": 4, "down": 4, "204502": 4, "869": 4, "485": 4, "595": 4, "0545": 4, "24600": 4, "0765": 4, "527": 4, "106": 4, "028": 4, "mani": [4, 21, 32], "level": 4, "intuit": 4, "bit": 4, "cryptic": 4, "visit": 4, "webpag": 4, "analysi": 4, "exclud": 4, "nonetheless": 4, "keep": [4, 23, 26, 29], "object": [4, 5, 19, 23, 25, 26, 27, 29, 30, 31, 34, 38, 40], "futur": 4, "19": 4, "song_nam": 4, "drop": [4, 23, 26], "specif": [4, 5, 13], "coeffici": [4, 30], "origin": 4, "befor": [4, 5, 30, 34], "reason": 4, "intermedi": 4, "group": [4, 31], "datapoint": [4, 31], "them": [4, 5, 13, 23, 26, 36], "panda": 4, "seri": 4, "creat": [4, 6, 29], "groupeddataset": [4, 31], "grouped_dataset": 4, "from_dataset": [4, 31], "data_group": [4, 31], "contribut": 4, "gradientboostingregressor": 4, "ani": [4, 31, 32, 36, 38], "xgboost": 4, "lightgbm": 4, "work": [4, 34], "run": [4, 5, 21, 23, 26, 30, 32, 34, 36], "without": [4, 30, 32], "issu": 4, "pass": [4, 15, 16, 23, 26, 31, 34, 36, 37], "string": [4, 5, 37], "standard": [4, 14, 21, 23, 26], "find": 4, "avail": 4, "option": [4, 7, 10, 13, 14, 15, 16, 21, 23, 26, 29, 30, 31, 32, 34, 36, 37, 40], "There": [4, 5], "defin": [4, 15, 16, 37], "own": 4, "plan": 4, "enable_cach": [4, 40], "make": [4, 5, 31], "sure": [4, 5], "restart": 4, "simpli": 4, "memcach": [4, 5, 29, 30], "get_shapley_valu": [4, 37], "ensembl": 4, "n_estim": 4, "neg_mean_absolute_error": 4, "dvl_df": 4, "num_work": [4, 23, 24, 26, 30, 36], "hold": [4, 15, 16], "second": [4, 5, 11, 12, 23, 26, 29, 30, 34, 36], "actual": 4, "manag": 4, "datafram": [4, 31, 37], "data_kei": 4, "shapley_dv": [4, 30], "dval_std": 4, "426819": 4, "171583": 4, "blackpink": 4, "330279": 4, "147117": 4, "summer": 4, "226239": 4, "123429": 4, "ava": 4, "max": 4, "211838": 4, "148645": 4, "silent\u00f3": 4, "187947": 4, "069981": 4, "thing": 4, "sort": [4, 22], "ascend": 4, "correspond": [4, 29], "coincid": 4, "name": [4, 5, 31], "third": 4, "deviat": [4, 21, 23, 26], "lowest": 4, "errorbar": 4, "mind": 4, "montecarlo": [4, 5, 8, 23, 27], "step": [4, 10, 32], "arriv": 4, "bias": 4, "plot_shaplei": [4, 37], "low_dvl": 4, "iloc": 4, "fig": 4, "shapley_pydvl": 4, "var": 4, "folder": 4, "kj": 4, "nzr59d991gj0y17m_d24hfyr0000gn": 4, "ipykernel_4182": 4, "1298377207": 4, "userwarn": 4, "modul": [4, 6, 11, 12, 13, 15, 16, 17], "matplotlib_inlin": 4, "backend_inlin": 4, "gui": 4, "backend": [4, 8, 23, 24, 26, 28, 30, 33, 36], "cannot": 4, "lot": 4, "decreas": 4, "when": [4, 23, 26, 27, 29, 30, 31, 34], "present": 4, "what": [4, 6], "remov": [4, 22], "new": 4, "low_dvl_artist": 4, "to_list": 4, "artist_filt": 4, "isin": 4, "x_train_good_dvl": 4, "y_train_good_dvl": 4, "absolut": 4, "were": 4, "mean_absolute_error": 4, "full_model": 4, "917794810679457": 4, "49470900052308": 4, "improv": 4, "than": [4, 13, 14, 23, 25, 29], "self": [4, 34], "consist": 4, "process": [4, 23, 26, 30, 34, 36], "interest": 4, "monitor": 4, "author": 4, "highest": 4, "28": 4, "high_dvl": 4, "3974558511": 4, "rihanna": 4, "her": 4, "re": [4, 6, 29, 30], "must": [4, 34, 37], "reus": [4, 5], "old": 4, "would": 4, "mistak": 4, "modifi": [4, 23, 25], "even": [4, 30], "29": 4, "y_train_anomal": 4, "anomalous_dataset": 4, "grouped_anomalous_dataset": 4, "1035400712": 4, "contributor": 4, "impact": [4, 30], "instal": [5, 6], "proceed": 5, "memori": 5, "chunk": [5, 36], "certain": [5, 23, 26, 30, 34], "either": [5, 38], "directli": [5, 34], "system": 5, "wiki": [5, 10], "u": [5, 19, 23, 26, 27], "Or": 5, "insid": 5, "docker": 5, "rm": 5, "11211": [5, 29, 30], "latest": [5, 7], "v": [5, 10, 11, 12, 17, 32], "enabl": 5, "default": [5, 7, 10, 29, 30], "disabl": [5, 21, 29], "desir": 5, "throughout": 5, "codebas": 5, "model_select": 5, "train_test_split": [5, 31], "arang": [5, 36], "reshap": 5, "random_st": [5, 31], "linear_model": [5, 14, 32], "linearregress": 5, "naiv": [5, 8, 18, 23, 26], "purpos": [5, 31], "loo": [5, 8], "naive_loo": [5, 19], "game": 5, "theoret": 5, "truncat": 5, "most": [5, 30], "effici": [5, 10], "truncated_montecarlo_shaplei": [5, 23, 26], "report": [5, 8, 31, 34], "shapley_result": [5, 21], "compute_fb_scor": [5, 22], "analyt": [5, 32], "well": [5, 38], "provid": 5, "support": [5, 13, 14, 30], "choic": 5, "ot": 5, "pin": 5, "furthermor": 5, "distinguish": 5, "between": 5, "These": [5, 31], "appli": [5, 36], "linear_influ": [5, 14], "subsequ": 5, "inner": 5, "definit": [5, 10, 23, 26, 27], "applic": 5, "capabl": 5, "product": [5, 10, 11, 12, 17], "sometim": 5, "possibl": 5, "complet": [5, 13], "invert": 5, "ad": 5, "call": [5, 21, 23, 25, 31, 34], "mention": [5, 30], "wise": 5, "usag": [5, 29, 36], "welcom": 6, "recommend": [6, 30], "get": [6, 7, 11, 12, 13, 32, 34], "guid": 6, "leav": [6, 19], "One": 6, "exact": [6, 23, 25, 27, 29], "twicedifferenti": [6, 11, 12, 17], "protocol": [6, 39], "link": 6, "sourc": [6, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 34, 35, 36, 37, 38, 39, 40], "repositori": 6, "api": 6, "index": [6, 7, 21, 31], "search": 6, "scikit": 7, "rai": [7, 23, 24, 26, 30, 34, 35, 36], "pymemcach": [7, 29, 30], "want": [7, 30], "releas": 7, "pip": 7, "develop": 7, "version": [7, 31], "testpypi": 7, "url": 7, "pypi": 7, "org": [7, 10], "simpl": [7, 15, 16, 21, 23, 27, 36], "execut": [7, 22, 36], "includ": 7, "thu": 7, "c": 7, "__version__": 7, "framework": [8, 9, 13], "torch_differenti": [8, 9, 11], "torch_wrapp": [8, 9, 15], "actor": [8, 23, 28, 33], "config": [8, 23, 24, 26, 28, 29, 34, 35, 36], "map_reduc": [8, 28, 33], "progress": [8, 11, 12, 13, 17, 19, 22, 23, 25, 26, 27, 28, 34], "batch": 10, "bound": 10, "batched_preconditioned_conjugate_gradi": 10, "union": [10, 11, 12, 15, 16, 30, 31, 36, 38, 40], "ndarrai": [10, 11, 12, 13, 14, 15, 16, 17, 21, 22, 31, 32, 36, 37, 39, 40], "callabl": [10, 11, 12, 13, 29, 32, 36, 40], "x0": 10, "rtol": 10, "1e": 10, "int": [10, 11, 12, 15, 16, 17, 19, 21, 22, 23, 26, 29, 30, 31, 32, 34, 36, 37, 38], "1000": [10, 32], "verify_assumpt": 10, "bool": [10, 11, 12, 13, 15, 16, 17, 19, 23, 25, 26, 27, 29, 30, 31, 34, 36, 38, 40], "raise_except": 10, "wikipedia": 10, "conjugate_gradient_method": 10, "github": [10, 34], "com": [10, 31, 34], "scipi": 10, "blob": [10, 34], "v1": 10, "spars": 10, "linalg": 10, "_isolv": 10, "iter": [10, 23, 26, 29, 30, 31, 32, 34, 36, 37, 38], "l282": 10, "l351": 10, "web": 10, "stanford": 10, "edu": 10, "ee364b": 10, "lectur": 10, "conj_grad_slid": 10, "pdf": 10, "On": 10, "constrain": 10, "maximum": [10, 36, 37], "repres": [10, 11, 12, 14, 15, 16, 32], "dimens": [10, 11, 12, 31], "multipl": 10, "ax": [10, 14, 15, 16], "inv": 10, "underli": 10, "symmetr": 10, "rel": [10, 29, 30], "toler": [10, 29, 30], "residu": 10, "norm": 10, "along": 10, "might": 10, "stabil": [10, 29], "iff": [10, 11, 12], "stochast": [10, 32], "rule": 10, "assumpt": 10, "rais": 10, "warn": [10, 23, 27], "torchtwicedifferenti": [11, 12], "tensor": [11, 12, 13, 15, 16], "mvp": [11, 12, 17], "num_param": [11, 12, 17], "integ": [11, 12, 31], "grad": [11, 12, 17], "tupl": [11, 12, 14, 15, 16, 23, 26, 30, 31, 32, 37], "nxd": [11, 12, 15, 16], "nxk": [11, 12, 13, 14, 15, 16], "shall": [11, 12], "nxp": [11, 12], "second_x": [11, 12, 17], "kwarg": [11, 12, 17, 19, 21, 24, 31, 34, 38, 39], "multipli": [11, 12], "part": 12, "machin": [12, 23, 26, 30], "inversionmethod": 13, "influencetyp": [13, 14], "dict": [13, 21, 22, 23, 26, 29, 30, 34, 36], "factor": 13, "over": [13, 17, 23, 26, 32], "supervis": 13, "mxk": [13, 14], "mxl": [13, 14], "nxl": [13, 14], "keyword": [13, 29, 36, 38], "argument": [13, 29, 30, 32, 36, 37, 38], "displai": [13, 19, 23, 25, 38], "bar": [13, 19, 22, 23, 25, 26, 27, 38], "specifi": 13, "str": [13, 21, 23, 27, 29, 30, 31, 37, 40], "enum": 13, "higher": [14, 30], "bxc": 14, "influences_up_linear_regression_analyt": 14, "influences_perturbation_linear_regression_analyt": 14, "bxcxm": 14, "torchlinearregress": [15, 16], "n_input": [15, 16], "n_output": [15, 16], "init": [15, 16], "torchmodel": [15, 16], "bia": [15, 16], "forward": [15, 16, 21, 22, 38], "ram": [15, 16], "layout": [15, 16], "output": [15, 16, 29], "sigmoid": [15, 16], "dot": [15, 16], "n_neurons_per_lay": [15, 16], "output_prob": [15, 16], "fulli": [15, 16], "connect": [15, 16], "v_k": [15, 16], "v_i": [15, 16, 32], "o": [15, 16], "v_": [15, 16], "v_1": [15, 16], "hidden": [15, 16], "demonstr": 16, "written": 16, "clariti": 16, "three": 16, "abc": [17, 34], "ordereddict": [19, 21, 22, 23, 25, 26, 27], "No": 19, "nor": [19, 23, 25], "shaded_mean_std": 21, "num_std": 21, "std": [21, 23, 26, 29, 34], "aggreg": [21, 34, 36], "shade": 21, "around": 21, "filenam": 21, "savefig": 21, "save": [21, 30], "dictionari": [21, 34], "all_valu": 21, "num_run": [21, 36], "num_point": 21, "backward_scor": 21, "backward_scores_revers": 21, "backward_random_scor": 21, "forward_scor": 21, "forward_scores_revers": 21, "forward_random_scor": 21, "score_nam": 21, "spearman_correl": 21, "vv": 21, "num_valu": 21, "pvalu": 21, "spearman": 21, "correl": 21, "pair": 21, "sort_valu": 22, "kt": 22, "vt": 22, "sample_id": 22, "value_float": 22, "sort_values_arrai": 22, "sort_values_histori": 22, "sequenc": [22, 31, 32, 36], "last": 22, "item": [22, 30], "backward_elimin": 22, "supervisedmodel": [22, 39, 40], "job_id": 22, "increment": 22, "duh": 22, "retrain": [22, 29], "dure": [22, 23, 26], "select": [22, 31], "backward": 22, "elimin": 22, "increas": 22, "score_toler": [23, 26], "n_job": [23, 26, 36], "parallelconfig": [23, 24, 26, 30, 34, 35, 36], "address": [23, 24, 26, 30, 35, 36], "coordinator_update_frequ": [23, 26], "worker_update_frequ": [23, 26], "sequenti": [23, 26], "permut": [23, 26, 27, 34], "until": [23, 26, 29, 30], "fall": [23, 26], "below": [23, 26, 29], "threshold": [23, 26, 34], "exce": [23, 26], "coordin": [23, 26, 34], "median": [23, 26], "termin": [23, 26, 34], "sum": [23, 26, 36], "exceed": [23, 26], "stop": [23, 26, 29, 32], "job": [23, 26, 36], "available_cpu": [23, 26, 35], "local": [23, 26, 30], "cluster": [23, 26, 30, 35, 36], "ip": [23, 26], "123": [23, 26], "45": [23, 26], "67": [23, 26], "89": [23, 26], "10001": [23, 26], "being": [23, 26, 31, 37], "dvl": [23, 26], "permutation_montecarlo_shaplei": [23, 26], "independ": [23, 26], "combinatorial_montecarlo_shaplei": [23, 26], "dist": [23, 26, 32], "powersetdistribut": [23, 26, 32], "combinatori": [23, 26, 27], "combinatorial_exact_shaplei": [23, 27], "too": [23, 27, 30], "mostli": [23, 27], "permutation_exact_shaplei": [23, 27], "classifi": [23, 25], "extract": [23, 25], "get_param": [23, 25], "get_shapley_coordin": 24, "arg": [24, 34, 39], "shapleycoordin": 24, "get_shapley_work": 24, "shapleywork": 24, "cacheinfo": 29, "miss": 29, "timeout": [29, 30, 36], "reconnect": 29, "serial": 29, "client_config": [29, 30], "memcachedclientconfig": [29, 30], "cache_threshold": [29, 30], "allow_repeated_train": [29, 30], "rtol_threshold": [29, 30], "min_repetit": [29, 30], "ignore_arg": [29, 30], "wrap": [29, 34, 38], "transpar": 29, "signatur": [29, 40], "track": 29, "determinist": [29, 30, 32], "same": [29, 30, 36, 37], "repetit": 29, "anymor": 29, "repeat": [29, 30, 36], "client": 29, "Will": 29, "merg": 29, "configur": [29, 30, 40], "reach": 29, "account": 29, "hash": 29, "para": 29, "onc": 29, "smaller": 29, "default_config": 29, "server": [29, 30], "localhost": [29, 30], "connect_timeout": [29, 30], "packet": 29, "consolid": 29, "no_delai": [29, 30], "serd": [29, 30], "pickleserd": [29, 30], "pickle_vers": 29, "exist": 30, "remot": [30, 34, 36], "worker": [30, 34], "0x7fb561eb8e50": 30, "memcachedconfig": [30, 40], "factori": 30, "super": 30, "fast": 30, "littl": 30, "prefer": 30, "workflow": 30, "observ": 30, "substanti": 30, "regul": 30, "similarli": 30, "reflect": 30, "feature_nam": 31, "data_nam": 31, "is_multi_output": 31, "better": 31, "handl": 31, "slice": 31, "get_train_data": 31, "train_indic": 31, "sub": 31, "get_test_data": 31, "test_indic": 31, "contigu": 31, "individu": 31, "dim": 31, "classmethod": 31, "bunch": 31, "load_": 31, "seed": 31, "coalit": 31, "referenc": 31, "min_year": 31, "download": 31, "music": 31, "www": 31, "kaggl": 31, "mrmorj": 31, "ci": 31, "pipelin": 31, "reduc": [31, 36], "sith": 31, "input_data": 31, "related_label": 31, "random_se": 31, "stuff": 32, "mse": 32, "binarylogisticregress": 32, "powerset": 32, "collect": 32, "power": 32, "grow": 32, "random_powerset": 32, "max_subset": 32, "uniformli": 32, "pre": 32, "accept": [32, 36], "arbitrarili": 32, "howev": 32, "ten": 32, "thousand": 32, "long": 32, "henc": 32, "abil": 32, "num_job": [32, 36], "wish": 32, "empti": [32, 34], "is_linear_funct": 32, "verify_sampl": 32, "noth": 32, "sum_i": 32, "a_i": 32, "is_positive_definit": 32, "linear_regression_analytical_derivative_d2_theta": 32, "bxm": 32, "nparrai": 32, "bxn": 32, "linear_regression_analytical_derivative_d_theta": 32, "bx": 32, "d_theta": 32, "d_b": 32, "linear_regression_analytical_derivative_d_x_d_theta": 32, "xm": 32, "rayactorwrapp": 34, "actor_handl": 34, "objectref": [34, 36], "parallel_backend": [34, 35, 36], "rayparallelbackend": [34, 35], "taken": 34, "almost": 34, "verbatim": 34, "janeliascicomp": 34, "janelia": 34, "remote_as_local_wrapp": 34, "init_parallel_backend": [34, 35], "def": 34, "__init__": 34, "wrapped_actor": 34, "add_result": 34, "worker_id": 34, "put": 34, "worker_statu": 34, "id": 34, "is_don": 34, "flag": 34, "otherwis": 34, "abstract": 34, "get_result": 34, "check_statu": 34, "cross": 34, "update_frequ": 34, "_permutation_montecarlo_shaplei": 34, "instanc": [35, 36], "num_cpu": 35, "mapreducejob": 36, "map_func": 36, "reduce_func": 36, "map_kwarg": 36, "reduce_kwarg": 36, "chunkify_input": 36, "n_run": 36, "max_parallel_task": 36, "embarrassingli": 36, "fun": 36, "alloc": 36, "90": 36, "whole": 36, "evenli": 36, "among": 36, "core": 36, "five": 36, "success": 36, "receiv": 36, "per": 36, "doe": 36, "wait": 36, "map_reduce_job": 36, "dval_df": 37, "vline": 37, "nx2": 37, "target_vari": 37, "format": 37, "mx2": 37, "thick": 37, "scatter": 37, "maybe_progress": 38, "tqdm_asyncio": 38, "mockprogress": 38, "mock": 38, "ignor": 38, "access": 38, "pedant": 39, "hint": 39, "catch_error": 40, "show_warn": 40, "default_scor": 40, "cache_opt": 40, "memoiz": 40}, "objects": {"": [[8, 0, 0, "-", "valuation"]], "valuation": [[9, 0, 0, "-", "influence"], [18, 0, 0, "-", "loo"], [20, 0, 0, "-", "reporting"], [23, 0, 0, "-", "shapley"], [28, 0, 0, "-", "utils"]], "valuation.influence": [[10, 0, 0, "-", "cg"], [11, 0, 0, "-", "frameworks"], [13, 0, 0, "-", "general"], [14, 0, 0, "-", "linear"], [15, 0, 0, "-", "model_wrappers"], [17, 0, 0, "-", "types"]], "valuation.influence.cg": [[10, 1, 1, "", "batched_preconditioned_conjugate_gradient"]], "valuation.influence.frameworks": [[11, 2, 1, "", "TorchTwiceDifferentiable"], [12, 0, 0, "-", "torch_differentiable"]], "valuation.influence.frameworks.TorchTwiceDifferentiable": [[11, 3, 1, "", "grad"], [11, 3, 1, "", "mvp"], [11, 3, 1, "", "num_params"]], "valuation.influence.frameworks.torch_differentiable": [[12, 2, 1, "", "TorchTwiceDifferentiable"]], "valuation.influence.frameworks.torch_differentiable.TorchTwiceDifferentiable": [[12, 3, 1, "", "grad"], [12, 3, 1, "", "mvp"], [12, 3, 1, "", "num_params"]], "valuation.influence.general": [[13, 2, 1, "", "InfluenceType"], [13, 2, 1, "", "InversionMethod"], [13, 1, 1, "", "influences"]], "valuation.influence.general.InfluenceType": [[13, 4, 1, "", "Perturbation"], [13, 4, 1, "", "Up"]], "valuation.influence.general.InversionMethod": [[13, 4, 1, "", "Cg"], [13, 4, 1, "", "Direct"]], "valuation.influence.linear": [[14, 1, 1, "", "influences_perturbation_linear_regression_analytical"], [14, 1, 1, "", "influences_up_linear_regression_analytical"], [14, 1, 1, "", "linear_influences"]], "valuation.influence.model_wrappers": [[15, 2, 1, "", "TorchBinaryLogisticRegression"], [15, 2, 1, "", "TorchLinearRegression"], [15, 2, 1, "", "TorchNeuralNetwork"], [16, 0, 0, "-", "torch_wrappers"]], "valuation.influence.model_wrappers.TorchBinaryLogisticRegression": [[15, 3, 1, "", "forward"], [15, 4, 1, "", "training"]], "valuation.influence.model_wrappers.TorchLinearRegression": [[15, 3, 1, "", "forward"], [15, 4, 1, "", "training"]], "valuation.influence.model_wrappers.TorchNeuralNetwork": [[15, 3, 1, "", "forward"], [15, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers": [[16, 2, 1, "", "TorchBinaryLogisticRegression"], [16, 2, 1, "", "TorchLinearRegression"], [16, 2, 1, "", "TorchNeuralNetwork"]], "valuation.influence.model_wrappers.torch_wrappers.TorchBinaryLogisticRegression": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers.TorchLinearRegression": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers.TorchNeuralNetwork": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.types": [[17, 2, 1, "", "TwiceDifferentiable"]], "valuation.influence.types.TwiceDifferentiable": [[17, 3, 1, "", "grad"], [17, 3, 1, "", "mvp"], [17, 3, 1, "", "num_params"]], "valuation.loo": [[19, 0, 0, "-", "naive"]], "valuation.loo.naive": [[19, 1, 1, "", "naive_loo"]], "valuation.reporting": [[21, 0, 0, "-", "plots"], [22, 0, 0, "-", "scores"]], "valuation.reporting.plots": [[21, 1, 1, "", "shaded_mean_std"], [21, 1, 1, "", "shapley_results"], [21, 1, 1, "", "spearman_correlation"]], "valuation.reporting.scores": [[22, 1, 1, "", "backward_elimination"], [22, 1, 1, "", "compute_fb_scores"], [22, 1, 1, "", "sort_values"], [22, 1, 1, "", "sort_values_array"], [22, 1, 1, "", "sort_values_history"]], "valuation.shapley": [[24, 0, 0, "-", "actor"], [23, 1, 1, "", "combinatorial_exact_shapley"], [23, 1, 1, "", "combinatorial_montecarlo_shapley"], [25, 0, 0, "-", "knn"], [23, 1, 1, "", "knn_shapley"], [26, 0, 0, "-", "montecarlo"], [27, 0, 0, "-", "naive"], [23, 1, 1, "", "permutation_exact_shapley"], [23, 1, 1, "", "permutation_montecarlo_shapley"], [23, 1, 1, "", "truncated_montecarlo_shapley"]], "valuation.shapley.actor": [[24, 1, 1, "", "get_shapley_coordinator"], [24, 1, 1, "", "get_shapley_worker"]], "valuation.shapley.knn": [[25, 1, 1, "", "knn_shapley"]], "valuation.shapley.montecarlo": [[26, 1, 1, "", "combinatorial_montecarlo_shapley"], [26, 1, 1, "", "permutation_montecarlo_shapley"], [26, 1, 1, "", "truncated_montecarlo_shapley"]], "valuation.shapley.naive": [[27, 1, 1, "", "combinatorial_exact_shapley"], [27, 1, 1, "", "permutation_exact_shapley"]], "valuation.utils": [[29, 0, 0, "-", "caching"], [30, 0, 0, "-", "config"], [31, 0, 0, "-", "dataset"], [32, 0, 0, "-", "numeric"], [33, 0, 0, "-", "parallel"], [37, 0, 0, "-", "plotting"], [38, 0, 0, "-", "progress"], [39, 0, 0, "-", "types"], [40, 0, 0, "-", "utility"]], "valuation.utils.caching": [[29, 2, 1, "", "CacheInfo"], [29, 1, 1, "", "memcached"], [29, 1, 1, "", "serialize"]], "valuation.utils.caching.CacheInfo": [[29, 4, 1, "", "errors"], [29, 4, 1, "", "hits"], [29, 4, 1, "", "misses"], [29, 4, 1, "", "reconnects"], [29, 4, 1, "", "sets"], [29, 4, 1, "", "timeouts"]], "valuation.utils.config": [[30, 2, 1, "", "MemcachedClientConfig"], [30, 2, 1, "", "MemcachedConfig"], [30, 2, 1, "", "ParallelConfig"]], "valuation.utils.config.MemcachedClientConfig": [[30, 4, 1, "", "connect_timeout"], [30, 3, 1, "", "items"], [30, 3, 1, "", "keys"], [30, 4, 1, "", "no_delay"], [30, 4, 1, "", "serde"], [30, 4, 1, "", "server"], [30, 4, 1, "", "timeout"], [30, 3, 1, "", "update"]], "valuation.utils.config.MemcachedConfig": [[30, 4, 1, "", "allow_repeated_training"], [30, 4, 1, "", "cache_threshold"], [30, 4, 1, "", "client_config"], [30, 4, 1, "", "ignore_args"], [30, 3, 1, "", "items"], [30, 3, 1, "", "keys"], [30, 4, 1, "", "min_repetitions"], [30, 4, 1, "", "rtol_threshold"], [30, 3, 1, "", "update"]], "valuation.utils.config.ParallelConfig": [[30, 4, 1, "", "address"], [30, 4, 1, "", "backend"], [30, 4, 1, "", "num_workers"]], "valuation.utils.dataset": [[31, 2, 1, "", "Dataset"], [31, 2, 1, "", "GroupedDataset"], [31, 1, 1, "", "load_spotify_dataset"], [31, 1, 1, "", "load_wine_dataset"]], "valuation.utils.dataset.Dataset": [[31, 5, 1, "", "data_names"], [31, 5, 1, "", "dim"], [31, 3, 1, "", "feature"], [31, 3, 1, "", "from_sklearn"], [31, 3, 1, "", "get_test_data"], [31, 3, 1, "", "get_train_data"], [31, 5, 1, "", "indices"], [31, 3, 1, "", "target"]], "valuation.utils.dataset.GroupedDataset": [[31, 5, 1, "", "data_names"], [31, 3, 1, "", "from_dataset"], [31, 3, 1, "", "from_sklearn"], [31, 3, 1, "", "get_train_data"], [31, 5, 1, "", "indices"]], "valuation.utils.numeric": [[32, 1, 1, "", "is_linear_function"], [32, 1, 1, "", "is_positive_definite"], [32, 1, 1, "", "linear_regression_analytical_derivative_d2_theta"], [32, 1, 1, "", "linear_regression_analytical_derivative_d_theta"], [32, 1, 1, "", "linear_regression_analytical_derivative_d_x_d_theta"], [32, 1, 1, "", "powerset"], [32, 1, 1, "", "random_powerset"]], "valuation.utils.parallel": [[34, 0, 0, "-", "actor"], [35, 0, 0, "-", "backend"], [36, 0, 0, "-", "map_reduce"]], "valuation.utils.parallel.actor": [[34, 2, 1, "", "Coordinator"], [34, 2, 1, "", "RayActorWrapper"], [34, 2, 1, "", "Worker"]], "valuation.utils.parallel.actor.Coordinator": [[34, 3, 1, "", "add_results"], [34, 3, 1, "", "check_status"], [34, 3, 1, "", "get_results"], [34, 3, 1, "", "is_done"]], "valuation.utils.parallel.actor.Worker": [[34, 3, 1, "", "run"]], "valuation.utils.parallel.backend": [[35, 1, 1, "", "available_cpus"], [35, 1, 1, "", "init_parallel_backend"]], "valuation.utils.parallel.map_reduce": [[36, 2, 1, "", "MapReduceJob"]], "valuation.utils.parallel.map_reduce.MapReduceJob": [[36, 3, 1, "", "map"], [36, 5, 1, "", "n_jobs"], [36, 5, 1, "", "parallel_backend"], [36, 3, 1, "", "reduce"]], "valuation.utils.plotting": [[37, 1, 1, "", "plot_dataset"], [37, 1, 1, "", "plot_influences"], [37, 1, 1, "", "plot_iris"], [37, 1, 1, "", "plot_shapley"]], "valuation.utils.progress": [[38, 1, 1, "", "maybe_progress"]], "valuation.utils.types": [[39, 2, 1, "", "SupervisedModel"]], "valuation.utils.types.SupervisedModel": [[39, 3, 1, "", "fit"], [39, 3, 1, "", "predict"], [39, 3, 1, "", "score"]], "valuation.utils.utility": [[40, 2, 1, "", "Utility"]], "valuation.utils.utility.Utility": [[40, 4, 1, "", "data"], [40, 4, 1, "", "model"], [40, 4, 1, "", "scoring"], [40, 5, 1, "", "signature"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"]}, "titleterms": {"exampl": 0, "influenc": [1, 2, 5, 9], "function": [1, 2], "data": [1, 2, 4], "mislabel": 1, "plot": [1, 21, 37], "dataset": [1, 2, 5, 31], "train": 1, "model": 1, "calcul": [1, 2], "appendix": 1, "decis": 1, "boundari": 1, "clean": 2, "us": [2, 5], "neural": 2, "network": 2, "fit": 2, "small": 2, "conjug": 2, "gradient": 2, "beyond": 2, "pydvl": [2, 4, 6, 7], "knn": [3, 25], "shaplei": [3, 4, 5, 23], "corrupt": 3, "label": 3, "valuat": [4, 8], "evalu": 4, "anomal": 4, "get": 5, "start": 5, "creat": 5, "util": [5, 28, 40], "comput": 5, "leav": 5, "One": 5, "out": 5, "valu": 5, "direct": 5, "linear": [5, 14], "exact": 5, "twicedifferenti": 5, "protocol": 5, "approxim": 5, "matrix": 5, "invers": 5, "perturb": 5, "what": [5, 7], "s": [5, 7], "next": [5, 7], "document": 6, "tabl": 6, "content": 6, "indic": 6, "instal": 7, "depend": 7, "cg": 10, "framework": 11, "torch_differenti": 12, "gener": 13, "model_wrapp": 15, "torch_wrapp": 16, "type": [17, 39], "loo": 18, "naiv": [19, 27], "report": 20, "score": 22, "actor": [24, 34], "montecarlo": 26, "cach": 29, "config": 30, "numer": 32, "parallel": 33, "backend": 35, "map_reduc": 36, "progress": 38}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 56}})
Search.setIndex({"docnames": ["examples/data_utility_learning", "examples/index", "examples/influence_synthetic", "examples/influence_wine", "examples/knn_shapley_flowers", "examples/shapley_spotify", "getting-started", "index", "install", "valuation/index", "valuation/influence", "valuation/influence/conjugate_gradient", "valuation/influence/frameworks", "valuation/influence/frameworks/torch_differentiable", "valuation/influence/general", "valuation/influence/linear", "valuation/influence/model_wrappers", "valuation/influence/model_wrappers/torch_wrappers", "valuation/influence/types", "valuation/loo", "valuation/loo/naive", "valuation/reporting", "valuation/reporting/plots", "valuation/reporting/scores", "valuation/shapley", "valuation/shapley/actor", "valuation/shapley/knn", "valuation/shapley/montecarlo", "valuation/shapley/naive", "valuation/utils", "valuation/utils/caching", "valuation/utils/config", "valuation/utils/dataset", "valuation/utils/numeric", "valuation/utils/parallel", "valuation/utils/parallel/actor", "valuation/utils/parallel/backend", "valuation/utils/parallel/map_reduce", "valuation/utils/plotting", "valuation/utils/progress", "valuation/utils/types", "valuation/utils/utility"], "filenames": ["examples/data_utility_learning.ipynb", "examples/index.rst", "examples/influence_synthetic.ipynb", "examples/influence_wine.ipynb", "examples/knn_shapley_flowers.ipynb", "examples/shapley_spotify.ipynb", "getting-started.rst", "index.rst", "install.rst", "valuation/index.rst", "valuation/influence.rst", "valuation/influence/conjugate_gradient.rst", "valuation/influence/frameworks.rst", "valuation/influence/frameworks/torch_differentiable.rst", "valuation/influence/general.rst", "valuation/influence/linear.rst", "valuation/influence/model_wrappers.rst", "valuation/influence/model_wrappers/torch_wrappers.rst", "valuation/influence/types.rst", "valuation/loo.rst", "valuation/loo/naive.rst", "valuation/reporting.rst", "valuation/reporting/plots.rst", "valuation/reporting/scores.rst", "valuation/shapley.rst", "valuation/shapley/actor.rst", "valuation/shapley/knn.rst", "valuation/shapley/montecarlo.rst", "valuation/shapley/naive.rst", "valuation/utils.rst", "valuation/utils/caching.rst", "valuation/utils/config.rst", "valuation/utils/dataset.rst", "valuation/utils/numeric.rst", "valuation/utils/parallel.rst", "valuation/utils/parallel/actor.rst", "valuation/utils/parallel/backend.rst", "valuation/utils/parallel/map_reduce.rst", "valuation/utils/plotting.rst", "valuation/utils/progress.rst", "valuation/utils/types.rst", "valuation/utils/utility.rst"], "titles": ["Data Utility Learning", "Examples", "Influence functions for data mislabeling", "Influence functions and neural networks", "KNN Shapley", "PyDVL - Shapley for data valuation", "Getting started", "pyDVL Documentation", "Installing pyDVL", "valuation", "influence", "conjugate_gradient", "frameworks", "torch_differentiable", "general", "linear", "model_wrappers", "torch_wrappers", "types", "loo", "naive", "reporting", "plots", "scores", "shapley", "actor", "knn", "montecarlo", "naive", "utils", "caching", "config", "dataset", "numeric", "parallel", "actor", "backend", "map_reduce", "plotting", "progress", "types", "utility"], "terms": {"thi": [0, 2, 3, 4, 5, 6, 7, 8, 12, 13, 30, 32, 33, 41], "page": [0, 2, 3, 4, 5, 7], "wa": [0, 2, 3, 4, 5, 30], "gener": [0, 2, 3, 4, 5, 6, 9, 10, 33, 37], "from": [0, 2, 3, 4, 5, 6, 8, 11, 14, 22, 23, 24, 26, 27, 32, 33, 35, 36, 37, 38, 41], "notebook": [0, 2, 3, 4, 5], "data_utility_learn": 0, "ipynb": [0, 2, 3, 4, 5], "interact": [0, 2, 3, 4, 5], "onlin": [0, 2, 3, 4, 5], "version": [0, 2, 3, 4, 5, 8, 32, 41], "introduc": [0, 2, 5], "method": [0, 2, 3, 4, 5, 6, 14, 24, 28, 32, 33, 39], "improv": [0, 5, 41], "effici": [0, 6, 11], "comput": [0, 2, 3, 4, 5, 7, 14, 20, 22, 23, 24, 26, 27, 28, 30, 31, 33, 41], "valu": [0, 2, 3, 4, 5, 7, 12, 13, 14, 22, 23, 24, 26, 27, 28, 30, 31, 32, 33, 35, 38, 41], "estim": [0, 3, 5, 33], "perform": [0, 3, 5, 16, 17, 31], "algorithm": [0, 4, 11, 14, 15, 41], "unseen": 0, "combin": 0, "i": [0, 2, 3, 4, 5, 12, 13, 14, 16, 17, 22, 30, 33, 41], "e": [0, 2, 3, 4, 14, 22, 24, 27, 30, 33, 37, 38, 41], "subset": [0, 2, 5, 32, 33, 38], "The": [0, 2, 3, 4, 5, 6, 18, 22, 24, 26, 30, 31, 32, 38], "describ": [0, 5], "paper": [0, 3, 4], "cooper": [0, 41], "game": [0, 6, 41], "theori": [0, 2, 41], "base": [0, 2, 12, 13, 14, 16, 17, 18, 30, 31, 32, 35, 37, 40, 41], "valuat": [0, 1, 2, 3, 4, 6, 7, 8, 31, 33, 35, 36, 37, 41], "via": [0, 2, 12, 13, 41], "phi_i": 0, "v": [0, 6, 11, 12, 13, 18], "point": [0, 2, 3, 4, 5, 12, 13, 14, 15, 18, 23, 24, 27, 32, 38], "defin": [0, 5, 12, 13, 16, 17, 38], "frac": [0, 2], "1": [0, 2, 3, 4, 5, 11, 14, 16, 17, 22, 24, 27, 30, 31, 33, 37, 41], "n": [0, 2, 12, 13, 14, 15, 16, 17, 18, 32, 33, 38], "sigma_": 0, "s": [0, 2, 3, 4, 5, 7, 22, 24, 27, 33, 38, 41], "subseteq": 0, "setminu": 0, "binom": 0, "cup": 0, "For": [0, 2, 3, 4, 5, 6, 14, 22, 31], "we": [0, 2, 3, 4, 5, 6, 7, 24, 27, 31, 37], "first": [0, 2, 3, 5, 7, 12, 13, 14, 24, 27, 32, 41], "start": [0, 3, 4, 5, 7, 8, 22, 24, 27, 31, 35, 37], "sampl": [0, 2, 4, 6, 24, 27, 32, 33, 41], "s_": 0, "train": [0, 1, 4, 5, 6, 7, 14, 15, 16, 17, 23, 24, 28, 30, 31, 32, 38, 41], "s_i": 0, "_": [0, 41], "m_": 0, "where": [0, 2, 6, 12, 13, 14, 33, 38], "number": [0, 2, 3, 6, 11, 12, 13, 14, 18, 22, 24, 27, 30, 31, 32, 33, 35, 36, 37, 38, 41], "call": [0, 2, 6, 22, 24, 26, 32, 35, 41], "budget": [0, 41], "ar": [0, 2, 3, 4, 5, 6, 12, 13, 14, 15, 17, 22, 30, 31, 32, 33, 37, 41], "transform": 0, "boolean": 0, "vector": [0, 2, 6, 11, 12, 13, 18, 33], "which": [0, 2, 3, 4, 5, 6, 12, 13, 14, 15, 24, 27, 30, 35, 39, 41], "index": [0, 7, 8, 22, 32], "j": [0, 3, 14], "mean": [0, 2, 3, 4, 5, 6, 22, 30], "th": 0, "present": [0, 5], "mapsto": 0, "0": [0, 2, 3, 4, 5, 6, 11, 14, 22, 23, 30, 31, 32, 37, 41], "after": [0, 2, 5, 23, 30, 33, 35], "fit": [0, 1, 2, 5, 6, 7, 23, 40, 41], "regress": [0, 2, 6, 15, 16, 17, 33, 41], "tild": 0, "collect": [0, 33], "us": [0, 2, 3, 4, 5, 7, 8, 11, 12, 13, 14, 15, 16, 17, 22, 24, 26, 27, 28, 30, 31, 32, 33, 35, 37, 38, 41], "instead": [0, 2, 5, 14, 24, 27, 30, 31, 37, 41], "predict": [0, 2, 3, 5, 12, 13, 14, 33, 40, 41], "remain": [0, 5], "main": [0, 4, 5, 35], "assumpt": [0, 3], "here": [0, 5, 6, 22, 40], "much": [0, 2, 4, 31], "faster": 0, "than": [0, 5, 14, 15, 24, 26, 30], "exact": [0, 7, 24, 26, 28, 30, 33], "load_ext": [0, 5], "autoreload": [0, 5], "2": [0, 2, 3, 4, 5, 6, 11, 16, 17, 33, 37, 38, 41], "matplotlib": [0, 2, 3, 4, 5, 8, 22], "inlin": 0, "os": [0, 4], "random": [0, 2, 31, 32, 33], "concurr": 0, "futur": [0, 5], "as_complet": 0, "processpoolexecutor": 0, "warn": [0, 24, 28, 41], "simplefilt": 0, "pyplot": [0, 2, 3, 4], "plt": [0, 2, 3, 4, 22], "numpi": [0, 2, 3, 4, 6, 8, 37], "np": [0, 2, 3, 4, 6, 12, 13, 14, 15, 23, 33, 37], "panda": [0, 5], "pd": 0, "sklearn": [0, 2, 3, 4, 5, 6, 23, 32, 41], "load_iri": [0, 4, 41], "neural_network": 0, "mlpregressor": 0, "svm": 0, "linearsvc": 0, "metric": [0, 2, 3, 5], "accuracy_scor": 0, "model_select": [0, 6], "train_test_split": [0, 6, 32], "except": 0, "convergencewarn": 0, "tqdm": [0, 4, 8, 24, 27, 28, 39], "auto": [0, 4, 24, 27], "datautilitylearn": [0, 41], "top_k_value_accuraci": [0, 33], "get_shapley_valu": 0, "ignor": [0, 39], "categori": 0, "3": [0, 2, 3, 4, 5, 8, 30, 31, 32, 33, 37, 41], "rcparam": 0, "figur": [0, 2, 3, 5, 38], "figsiz": [0, 2, 3, 5, 38], "16": [0, 3, 5, 6], "10": [0, 2, 3, 4, 5, 11, 24, 27, 28, 37, 38], "font": 0, "size": [0, 3, 11, 12, 13, 14, 18, 32, 33, 38], "15": [0, 5], "xtick": [0, 3], "labels": 0, "ytick": 0, "4": [0, 3, 4, 5], "random_st": [0, 6, 32], "24": [0, 2, 5, 32], "environ": 0, "get": [0, 7, 8, 12, 13, 14, 33, 35], "ci": [0, 32], "train_siz": [0, 2, 3, 32], "5": [0, 2, 3, 4, 5, 6, 24, 27, 35, 37], "training_budget_valu": 0, "arang": [0, 6, 37], "n_iter": 0, "els": [0, 2, 3], "100": [0, 2, 3, 5, 6, 11], "8000": 0, "250": 0, "mlp_kwarg": 0, "dict": [0, 14, 22, 23, 24, 27, 30, 31, 35, 37], "hidden_layer_s": 0, "20": [0, 2, 3, 5, 24, 28, 37, 38], "activ": 0, "relu": 0, "solver": 0, "adam": [0, 3], "learning_rate_init": 0, "001": [0, 11], "batch_siz": [0, 2, 3], "32": 0, "max_it": 0, "800": [0, 5], "seed": [0, 32], "just": [0, 2, 5, 31], "like": [0, 2, 3, 5, 33], "take": [0, 2, 3, 4, 5, 6, 7, 30, 31, 33, 37, 41], "iri": [0, 4, 38], "all": [0, 3, 4, 5, 6, 8, 12, 13, 14, 15, 17, 18, 24, 27, 28, 32, 33, 37, 41], "test": [0, 2, 3, 5, 6, 8, 14, 15, 17, 23, 24, 28, 32, 38], "set": [0, 2, 3, 5, 14, 15, 22, 23, 24, 27, 28, 30, 31, 32, 33, 35, 37, 38, 39, 41], "case": [0, 2, 5, 6, 24, 28, 31, 41], "accuraci": [0, 2, 3, 33, 35], "6": [0, 3, 4, 5], "x": [0, 2, 6, 12, 13, 14, 15, 16, 17, 18, 22, 30, 33, 35, 38, 40], "y": [0, 2, 3, 6, 12, 13, 14, 15, 16, 17, 18, 32, 33, 38, 40], "return_x_i": 0, "true": [0, 2, 3, 5, 11, 12, 13, 14, 16, 17, 20, 24, 26, 27, 28, 30, 31, 33, 35, 37, 39, 41], "x_train": [0, 2, 3, 5, 6, 15, 32, 38], "x_test": [0, 2, 5, 6, 14, 15, 32], "y_train": [0, 2, 3, 4, 5, 6, 15, 32], "y_test": [0, 2, 5, 6, 14, 15, 32], "stratifi": 0, "also": [0, 2, 3, 5, 8, 11, 38, 41], "support": [0, 6, 14, 15, 31], "classifi": [0, 24, 26], "obtain": [0, 2, 3, 12, 13], "an": [0, 2, 3, 4, 5, 6, 12, 13, 22, 24, 27, 32, 33, 36, 37, 38, 41], "around": [0, 22], "92": 0, "7": [0, 2, 3, 4, 5], "y_pred": [0, 33], "9259259259259259": 0, "8": [0, 3, 4, 5, 8, 11, 32, 38], "enable_cach": [0, 5, 41], "fals": [0, 5, 12, 13, 14, 18, 24, 27, 30, 31, 32, 35, 37, 39, 41], "9": [0, 3, 4, 5, 37], "df": 0, "u": [0, 6, 20, 24, 27, 28, 41], "mode": [0, 5], "combinatorial_exact": 0, "progress": [0, 9, 12, 13, 14, 18, 20, 23, 24, 26, 27, 28, 29, 35], "set_index": 0, "data_kei": [0, 5], "renam": 0, "column": [0, 3, 5, 32], "shapley_dv": [0, 5, 31], "Then": [0, 2, 5], "wrapper": [0, 3, 6, 41], "multi": 0, "layer": [0, 3, 16, 17], "perceptron": 0, "fulli": [0, 16, 17], "connect": [0, 16, 17], "network": [0, 1, 2, 7, 16, 17], "certain": [0, 6, 24, 27, 31, 35], "determin": [0, 2, 31], "training_budget": [0, 41], "pair": [0, 22], "correspond": [0, 5, 30], "def": [0, 35], "compute_shapley_valu": [0, 5, 38], "int": [0, 11, 12, 13, 16, 17, 18, 20, 22, 23, 24, 26, 27, 30, 31, 32, 33, 35, 37, 38, 39, 41], "dul_df": 0, "f": [0, 2, 3, 4, 11, 12, 13, 16, 17], "return": [0, 2, 3, 5, 11, 12, 13, 14, 15, 16, 17, 23, 24, 27, 28, 30, 31, 32, 33, 35, 36, 38, 39, 41], "executor": 0, "submit": 0, "rang": [0, 2, 4, 41], "timeout": [0, 30, 31, 37], "60": 0, "result": [0, 2, 3, 5, 6, 11, 22, 30, 35, 37, 41], "concat": 0, "axi": [0, 2, 3, 5, 22], "minimum": [0, 2, 3, 30, 31, 32, 38], "maximum": [0, 11, 14, 37, 38], "l_1": 0, "error": [0, 2, 3, 5, 6, 11, 24, 27, 30, 41], "differ": [0, 3, 14, 31, 32, 35], "plot": [0, 1, 3, 4, 5, 6, 7, 9, 21, 24, 27, 29], "11": [0, 3], "zero": [0, 2], "len": [0, 2, 3, 4, 32], "dtype": 0, "float": [0, 2, 11, 14, 20, 22, 23, 24, 26, 27, 28, 30, 31, 32, 33, 38, 40, 41], "k": [0, 4, 11, 16, 17, 33], "y_true": [0, 33], "y_estim": 0, "linalg": [0, 11], "norm": [0, 11], "ord": 0, "error_from_mean": 0, "12": [0, 3], "fig": [0, 5], "ax": [0, 11, 15, 16, 17], "subplot": 0, "r": [0, 2, 11, 37], "label": [0, 1, 2, 3, 5, 7, 12, 13, 14, 18, 32, 35, 38], "hline": 0, "min": 0, "max": [0, 5], "g": [0, 2, 3, 24, 27, 33, 37, 38, 41], "fill_between": 0, "facecolor": 0, "b": [0, 2, 11, 15, 16, 17, 33], "alpha": 0, "set_xlabel": 0, "set_ylabel": 0, "l_2": 0, "legend": [0, 2, 3], "show": [0, 2, 3, 4, 5], "As": [0, 2, 4, 5], "can": [0, 2, 3, 4, 5, 6, 8, 12, 13, 14, 31, 32, 33, 41], "seen": [0, 3], "abov": [0, 2, 4, 5, 31], "match": 0, "thu": [0, 8], "work": [0, 5, 35], "next": [0, 2, 3, 4, 5, 7, 35], "top": [0, 5, 11, 30, 33], "highest": [0, 5, 33], "13": [0, 3], "averag": [0, 2, 3, 4, 14, 24, 27, 30, 31, 33, 35], "14": [0, 3, 5], "best_training_budget": 0, "argmin": 0, "18": [0, 5, 38], "kind": 0, "bar": [0, 14, 20, 23, 24, 26, 27, 28, 39], "One": [0, 7], "interest": [0, 5], "wai": [0, 2, 6], "assess": [0, 3], "approach": [0, 2, 6], "corrupt": [0, 1, 2, 3, 5, 7], "some": [0, 2, 3, 4, 5], "monitor": [0, 5], "how": [0, 2, 3, 4, 5], "score": [0, 3, 4, 5, 6, 9, 20, 21, 24, 27, 28, 30, 31, 40, 41], "chang": [0, 2, 4, 5], "To": [0, 5, 7, 8], "do": [0, 5, 30], "its": [0, 2, 3, 5, 31], "highest_value_index": 0, "argmax": [0, 3], "y_train_corrupt": 0, "copi": [0, 2, 4, 5], "corrupted_dataset": [0, 4], "retrain": [0, 23, 30], "new": [0, 5], "notic": [0, 3, 4, 5, 32], "decreas": [0, 5], "17": 0, "8296296296296296": 0, "recomput": 0, "best": 0, "previous": 0, "df_corrupt": 0, "19": [0, 2, 5], "both": [0, 4], "approxim": [0, 2, 5, 7, 24, 27], "agre": 0, "fact": 0, "ha": [0, 2, 3, 4, 5, 11, 24, 27, 30, 31, 35], "lowest": [0, 5], "still": 0, "preliminari": 0, "practic": [0, 2, 5], "doesn": 0, "t": [0, 2, 5, 11, 33, 37], "go": [0, 2, 5, 6, 7, 8, 31], "below": [0, 24, 27, 30], "either": [0, 6, 39], "due": 0, "close": [0, 2, 15], "each": [0, 2, 3, 4, 5, 6, 12, 13, 15, 18, 22, 23, 24, 27, 30, 32, 33, 37, 38], "other": [0, 2, 3, 5, 24, 26, 28, 30, 33, 41], "why": 0, "better": [0, 2, 32, 41], "predictor": 0, "anyth": 0, "apart": 0, "data": [1, 4, 6, 7, 15, 20, 22, 23, 24, 26, 27, 28, 30, 32, 37, 38, 41], "util": [1, 2, 3, 4, 5, 7, 9, 20, 24, 27, 28, 31, 33, 35, 36, 37], "learn": [1, 3, 7, 8, 13, 31, 32, 41], "import": [1, 2, 3, 4, 5, 6, 7, 8, 14, 30, 33, 35, 36, 37, 41], "constant": [1, 7], "dataset": [1, 3, 4, 5, 7, 9, 23, 24, 26, 27, 29, 33, 38, 41], "model": [1, 4, 5, 6, 7, 12, 13, 14, 15, 16, 17, 18, 20, 23, 24, 26, 27, 28, 30, 31, 32, 38, 41], "shaplei": [1, 3, 7, 9, 23, 26, 27, 28, 31, 32, 33, 35, 38, 41], "evalu": [1, 7], "anomal": [1, 3, 4, 7], "influenc": [1, 7, 8, 9, 14, 15, 38], "function": [1, 4, 5, 6, 7, 8, 10, 11, 14, 15, 20, 24, 27, 28, 30, 32, 33, 37], "mislabel": [1, 7], "calcul": [1, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17, 18, 24, 27, 30, 31, 32, 33, 35, 41], "invers": [1, 3, 7, 14], "through": [1, 3, 4, 5, 7, 12, 13, 16, 17, 31], "conjug": [1, 3, 6, 7, 11, 14], "gradient": [1, 3, 6, 7, 11, 12, 13, 14, 18], "appendix": [1, 7], "decis": [1, 7, 33, 38], "boundari": [1, 7, 33, 38], "neural": [1, 2, 7, 16, 17], "small": [1, 6, 7, 30, 31], "featur": [1, 2, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 32, 38], "speed": [1, 5, 6, 7, 31, 41], "up": [1, 2, 5, 6, 7, 14, 15, 31, 41], "big": [1, 2, 7, 41], "knn": [1, 7, 9, 24], "pydvl": [1, 2, 3, 4, 6], "influence_synthet": 2, "In": [2, 3, 4, 5, 6, 8, 30, 31], "closer": [2, 6], "look": [2, 3, 5, 6], "help": [2, 5], "synthet": 2, "occur": 2, "whenev": [2, 3], "exampl": [2, 3, 6, 7, 22, 35, 36, 37, 41], "usual": [2, 22], "wrongli": 2, "real": [2, 6, 14, 31], "life": 2, "happen": [2, 5, 23, 41], "fairli": 2, "often": [2, 41], "consequ": 2, "human": 2, "nois": [2, 3], "let": [2, 3, 4, 5], "consid": 2, "classif": [2, 3], "problem": [2, 3, 6], "follow": [2, 3, 5, 6, 8, 14], "notat": 2, "begin": 2, "align": 2, "x_i": [2, 12, 13, 16, 17], "mathbb": 2, "d": [2, 12, 13], "y_i": [2, 12, 13, 16, 17], "foral": 2, "end": 2, "word": [2, 30], "have": [2, 3, 4, 5, 6, 30, 31, 35, 38, 41], "contain": [2, 6, 10, 11, 13, 14, 15, 16, 17, 32, 33, 41], "typic": [2, 3, 5, 12, 13, 14, 32, 41], "you": [2, 3, 5, 6, 7, 8, 31, 33], "think": 2, "indic": [2, 4, 23, 24, 27, 32, 33, 35, 38], "whether": [2, 14, 24, 26, 33, 35, 41], "patient": 2, "diseas": 2, "represent": 2, "now": [2, 3, 4, 5, 31], "toi": 2, "delv": 2, "assum": [2, 15], "bernoulli": 2, "binari": [2, 16, 17], "variabl": 2, "while": [2, 3, 5], "input": [2, 3, 5, 12, 13, 14, 15, 16, 17, 18, 30, 32, 37, 38], "dimension": [2, 38], "gaussian": 2, "distribut": [2, 3, 4, 24, 27, 30, 33], "depend": [2, 7, 31], "more": [2, 3, 4, 5, 6, 11, 14, 30, 31, 32], "precis": [2, 5, 30, 31], "sim": 2, "text": 2, "ber": 2, "left": [2, 8], "right": 2, "mathcal": 2, "mu_1": 2, "mu_2": 2, "sigma": 2, "fix": [2, 32], "diagon": 2, "covari": 2, "implement": [2, 4, 5, 11, 20, 23, 24, 27, 41], "scheme": 2, "python": [2, 8], "straightforward": 2, "achiev": [2, 14, 31], "afterward": 2, "code": [2, 33], "snippet": 2, "aforement": 2, "model_wrapp": [2, 3, 9, 10], "torchbinarylogisticregress": [2, 16, 17], "torch": [2, 3, 12, 13, 14], "nn": [2, 3, 12, 13, 14], "optim": [2, 3, 6, 16, 17, 38], "adamw": 2, "lr_schedul": [2, 3], "synthetic_classification_dataset": 2, "confusion_matrix": [2, 3], "confusionmatrixdisplai": [2, 3], "plot_dataset": [2, 38], "plot_influ": [2, 38], "num_sampl": 2, "10000": 2, "num_featur": 2, "asarrai": 2, "num_class": [2, 3], "train_d": [2, 3, 38], "val_d": [2, 3], "test_d": [2, 3, 38], "test_siz": [2, 3, 5, 6, 32], "given": [2, 3, 5, 12, 13, 14, 24, 27, 30, 32, 41], "simplic": [2, 3], "exactli": 2, "maxim": 2, "our": [2, 3, 5], "map": [2, 23, 37, 38], "continu": [2, 41], "line": [2, 38], "z": 2, "space": [2, 3, 4, 6], "detail": [2, 3, 5, 6, 11, 14], "decision_boundary_fixed_variance_2d": 2, "decision_boundary_fn": 2, "decision_boundari": 2, "linspac": 2, "respect": [2, 4, 6, 11, 12, 13, 14, 15, 18, 33], "21": [2, 5], "x_min": [2, 38], "x_max": [2, 38], "xlabel": [2, 3, 5, 38], "x_0": 2, "ylabel": [2, 3, 5, 38], "x_1": 2, "legend_titl": [2, 4, 38], "suptitl": [2, 4, 38], "note": [2, 17, 38], "across": [2, 3, 24, 27, 37], "discrimin": 2, "presenc": 2, "logist": [2, 16, 17], "done": [2, 4, 6], "39": 2, "devic": [2, 3], "cuda": [2, 3], "is_avail": [2, 3], "cpu": [2, 3, 31, 36, 37], "num_epoch": [2, 3], "50": [2, 6], "lr": [2, 3], "05": 2, "weight_decai": [2, 3], "128": 2, "param": [2, 3, 12, 13, 16, 17, 32, 38], "paramet": [2, 3, 6, 11, 12, 13, 14, 15, 18, 20, 22, 23, 24, 26, 27, 28, 30, 31, 32, 33, 35, 36, 37, 38, 39, 41], "schedul": [2, 3], "cosineannealinglr": [2, 3], "t_max": [2, 3], "train_loss": [2, 3], "val_loss": [2, 3], "astyp": 2, "x_val": [2, 3], "y_val": [2, 3], "loss": [2, 3, 6, 12, 13, 14, 18], "binary_cross_entropi": 2, "And": [2, 3, 5], "check": [2, 3, 8, 11, 24, 27, 35], "overfit": 2, "40": 2, "val": [2, 3], "A": [2, 11, 12, 13, 14, 15, 16, 17, 30, 32, 33, 35, 37, 38, 41], "confus": [2, 3], "matrix": [2, 3, 7, 11, 12, 13, 14, 22], "good": 2, "pred_prob": 2, "detach": [2, 3], "pred_y_test": [2, 3], "prob": 2, "cm": [2, 3], "disp": [2, 3], "lt": [2, 3], "_plot": [2, 3], "0x7f93524e5390": 2, "gt": [2, 3], "It": [2, 3, 6, 11, 12, 13, 16, 17, 18, 33, 35, 37, 41], "converg": [2, 5], "optimum": 2, "sinc": [2, 3, 5, 24, 28, 31], "landscap": 2, "y_1": 2, "x_2": 2, "y_2": 2, "colon": 2, "time": [2, 4, 7, 11, 30, 31, 35, 37, 41], "measur": 2, "onto": [2, 15], "condit": 2, "target": [2, 11, 12, 13, 15, 32], "trough": 2, "theta": 2, "If": [2, 3, 4, 5, 6, 7, 12, 13, 14, 20, 24, 27, 30, 31, 32, 35, 37, 41], "l": [2, 33], "differenti": [2, 12, 13], "nabla_": 2, "mathsf": 2, "h_": 2, "see": [2, 3, 4, 5, 6, 11, 33, 41], "understand": 2, "black": 2, "box": 2, "deriv": [2, 6, 12, 13, 33], "formula": 2, "25": [2, 5], "26": [2, 5], "compute_influ": [2, 3, 6, 14], "influence_valu": 2, "influence_typ": [2, 3, 6, 14, 15], "inversion_method": [2, 3, 6, 14], "direct": [2, 3, 7, 11, 12, 13, 14], "cg": [2, 3, 6, 14], "explicitli": [2, 17], "construct": [2, 6, 14, 32], "hessian": [2, 3, 6, 12, 13, 14, 18, 33], "computation": [2, 5], "expens": [2, 5, 24, 28], "should": [2, 3, 5, 6, 8, 11, 35], "bigger": [2, 3], "With": 2, "type": [2, 4, 6, 9, 10, 14, 29, 31], "shape": [2, 3, 11, 12, 13, 14, 15, 16, 17, 32, 33, 38], "nxm": [2, 14, 15, 33], "m": [2, 12, 13, 14, 33], "thei": [2, 3, 4, 5, 17, 41], "therefor": [2, 3, 18], "associ": [2, 32], "perturb": [2, 3, 7, 14, 15], "arrai": [2, 4, 12, 13, 35, 38], "nxmxf": 2, "ie": 2, "length": [2, 4, 12, 13, 18, 24, 28], "order": [2, 3, 5, 6, 8, 12, 13, 24, 27, 30, 33], "total": [2, 3, 5, 24, 27, 35, 38], "27": [2, 5], "mean_train_influ": [2, 3], "adjust": 2, "colorbar_limit": [2, 4, 38], "color": [2, 4, 22, 38], "28": [2, 5], "separ": [2, 5, 38], "tend": [2, 3, 4, 5], "move": [2, 3, 5, 24, 27], "awai": 2, "becom": [2, 24, 28], "posit": [2, 4, 11, 14, 23, 32], "neg": [2, 3, 5, 15], "further": [2, 6, 12, 13], "flip": [2, 3], "29": [2, 5], "y_corrupt": 2, "yi": 2, "30": [2, 3, 5, 35], "print": [2, 3, 4, 8, 12, 13, 24, 28, 41], "correct": 2, "9636368268108108": 2, "015261022581455445": 2, "31": 2, "corrupted_indic": [2, 4, 38], "red": [2, 4], "circl": [2, 4], "been": [2, 41], "especi": 2, "those": [2, 3, 32], "farther": 2, "involv": 2, "p": [2, 6, 12, 13, 14, 16, 17, 18], "requir": [2, 3, 6, 8], "o": [2, 16, 17], "oper": 2, "larger": 2, "quickli": 2, "unfeas": 2, "avoid": [2, 3], "explicit": [2, 5, 14], "techniqu": [2, 3, 5], "implicit": [2, 12, 13], "product": [2, 6, 11, 12, 13, 18], "hvp": 2, "cell": [2, 3, 4, 5], "factor": [2, 14], "veri": [2, 3, 5, 31, 33], "simpl": [2, 8, 14, 16, 17, 22, 24, 28, 37], "actual": [2, 5], "slow": 2, "choic": [2, 6, 41], "nevertheless": 2, "abl": 2, "verifi": 2, "same": [2, 30, 31, 37, 38, 41], "minor": 2, "directli": [2, 6, 35], "36": 2, "inversion_method_kwarg": [2, 14], "max_iter": [2, 5, 6, 11, 14, 22, 24, 27], "max_step_s": [2, 11, 14], "9105535060320019": 2, "014264478299049959": 2, "similar": 2, "ones": [2, 3, 4], "33": 2, "one": [2, 3, 5, 6, 12, 13, 14, 17, 20, 32, 37], "solv": 2, "equat": 2, "solut": [2, 11, 15], "probabl": [2, 16, 17], "singl": [2, 3, 5, 31], "varianc": [2, 30], "parameter": 2, "lai": [2, 3], "equidist": 2, "two": [2, 6, 35, 37, 38], "impli": 2, "descript": [2, 32], "form": [2, 15, 32], "enforc": 2, "term": [2, 3], "insert": 2, "previou": [2, 6], "az": 2, "write": 2, "symmetri": 2, "expect": [2, 3, 4, 5, 24, 27], "orthogon": 2, "found": [2, 3, 4, 24, 27, 32, 41], "underbrac": 2, "bmatrix": 2, "_a": 2, "_b": 2, "influence_win": 3, "arbitrari": [3, 6], "find": [3, 5], "wine": [3, 32], "regard": 3, "particular": 3, "bottl": 3, "relat": [3, 5, 24, 27, 32, 33], "physic": 3, "properti": [3, 32, 37, 39, 41], "concentr": 3, "magnesium": 3, "malic": 3, "acid": 3, "alcohol": 3, "percentag": 3, "etc": [3, 36, 37], "need": [3, 4, 5, 6, 14, 31], "class": [3, 4, 5, 6, 11, 12, 13, 14, 16, 17, 18, 30, 31, 32, 35, 37, 40, 41], "belong": 3, "pleas": [3, 4, 24, 28], "refer": [3, 5, 6, 7, 14, 24, 28, 32], "document": [3, 5, 6, 8], "load": [3, 4, 5, 32], "split": [3, 6, 23, 24, 26, 32, 37, 38], "valid": [3, 5, 15, 32], "larg": [3, 33], "less": [3, 4, 14, 15], "noisi": [3, 5, 30, 31], "load_wine_dataset": [3, 32], "torchneuralnetwork": [3, 16, 17], "f1_score": 3, "feature_nam": [3, 32], "num_corrupted_idx": 3, "tensor": [3, 12, 13, 14, 16, 17], "conveni": [3, 6, 41], "initi": [3, 32, 36], "pytorch": [3, 8, 12, 13, 14], "alreadi": [3, 5, 24, 27, 32], "skip": 3, "section": [3, 6, 8], "feature_dimens": 3, "unique_class": 3, "uniqu": [3, 4], "concaten": 3, "network_s": 3, "300": [3, 37], "005": 3, "01": 3, "cross_entropi": 3, "stabl": [3, 4, 32, 41], "0x7f9f35daca00": 3, "f1": 3, "weight": [3, 6, 24, 27, 31, 33], "9237276558881837": 3, "bumpi": 3, "dure": [3, 23, 24, 27, 41], "explor": 3, "until": [3, 24, 27, 30, 31], "configur": [3, 30, 31, 41], "minimis": 3, "There": [3, 5, 6], "least": 3, "local": [3, 24, 27, 31], "fulfil": 3, "mani": [3, 5, 22, 33], "issu": [3, 5], "aris": [3, 41], "scenario": 3, "regularis": 3, "deal": 3, "train_influ": [3, 38], "hessian_regular": [3, 14], "quantiti": 3, "equal": [3, 32, 35], "row": [3, 33, 38], "At": 3, "element": [3, 12, 13, 24, 27, 32, 38, 41], "a_": 3, "store": [3, 5, 6, 31], "everi": [3, 16, 17, 31], "overal": [3, 41], "histogram": 3, "within": [3, 32], "log": 3, "scale": 3, "hist": 3, "normal": [3, 41], "titl": [3, 5, 38], "influec": 3, "0x7f9f3e34fa00": 3, "effect": 3, "038906920670425504": 3, "013314601322270936": 3, "ultim": 3, "most": [3, 6, 31, 41], "relev": 3, "feature_influ": 3, "mean_feature_influ": 3, "rotat": 3, "necessari": [3, 11], "quit": [3, 5], "numer": [3, 9, 11, 29], "challeng": 3, "allow": [3, 30], "full": [3, 5, 6, 32], "onli": [3, 6, 14, 22, 24, 27, 31, 32, 40, 41], "current": [3, 5, 14, 15, 24, 27], "advis": 3, "cg_train_influ": 3, "mean_cg_train_influ": 3, "compar": [3, 4, 5, 33], "over": [3, 14, 18, 24, 27, 33], "ab": 3, "0005212358626344399": 3, "quick": 3, "introduct": 3, "interfac": 3, "despit": 3, "known": 3, "qualiti": 3, "out": [3, 7, 8, 20], "deep": [3, 5], "fragil": 3, "decai": 3, "add": [3, 24, 27], "amount": [3, 37], "experi": 3, "mai": [3, 5, 31], "give": [3, 5], "quantit": 3, "qualit": 3, "sever": [3, 5, 41], "realis": 3, "contrari": 3, "shown": 3, "robust": 3, "come": 3, "cost": 3, "high": [3, 4, 5, 14], "emploi": 3, "parallel": [3, 5, 9, 14, 20, 23, 29, 31, 33, 35, 36, 37], "cach": [3, 5, 6, 9, 20, 29, 31, 32, 41], "knn_shapley_flow": 4, "exponenti": 4, "complex": [4, 14], "linear": [4, 7, 9, 10, 11, 16, 17, 33], "explain": 4, "librari": [4, 5, 6, 7], "sy": 4, "pathlib": 4, "path": 4, "neighbor": 4, "kneighborsclassifi": [4, 24, 26], "plot_iri": [4, 38], "compute_knn_shaplei": [4, 24, 26], "user": [4, 6, 7], "fabio": 4, "miniconda3": 4, "env": 4, "data_shaplei": 4, "lib": 4, "python3": 4, "site": 4, "packag": 4, "py": [4, 5, 11, 35], "22": [4, 5], "tqdmwarn": 4, "iprogress": 4, "updat": [4, 24, 27, 30, 31], "jupyt": 4, "ipywidget": 4, "http": [4, 8, 11, 14, 32, 35, 41], "readthedoc": 4, "io": 4, "en": [4, 11], "user_instal": 4, "html": [4, 32, 41], "autonotebook": 4, "notebook_tqdm": 4, "info": [4, 32], "dedic": 4, "sklearn_dataset": 4, "from_sklearn": [4, 32, 41], "knn_shaplei": 4, "n_neighbor": 4, "shapley_valu": [4, 5], "30it": 4, "00": 4, "3708": 4, "27it": 4, "petal": 4, "sepal": 4, "flower": 4, "legend_label": [4, 38], "list": [4, 5, 16, 17, 22, 23, 32, 33, 37, 38], "target_nam": [4, 32], "none": [4, 11, 12, 13, 14, 16, 17, 18, 22, 24, 25, 27, 30, 31, 32, 33, 36, 37, 38, 41], "low": [4, 5, 14, 15], "becaus": [4, 5, 6, 16, 17], "accur": 4, "inform": [4, 5], "class_id": 4, "class_idx": 4, "enumer": [4, 6], "non": [4, 5, 31], "deepcopi": 4, "contaminated_shaplei": 4, "4361": 4, "49it": 4, "lower": 4, "valuabl": [4, 15], "corrupted_shapley_valu": 4, "idx": 4, "0060392220185388045": 4, "correct_shapley_valu": 4, "regular": [4, 14], "011729071554292213": 4, "confirm": 4, "025": 4, "027": 4, "regardless": 4, "assign": 4, "shapley_spotifi": 5, "advantag": 5, "popular": [5, 32], "song": [5, 32], "hit": [5, 30], "spotifi": [5, 32], "2000": 5, "2019": 5, "so": [5, 24, 27, 35], "highlight": 5, "boost": 5, "your": [5, 6, 31], "entri": 5, "briefli": 5, "42": 5, "extens": 5, "reload": 5, "reload_ext": 5, "load_spotify_dataset": [5, 32], "intern": [5, 6, 24, 28], "publish": 5, "2014": [5, 32], "anoth": [5, 12, 13], "x_input": 5, "y_label": 5, "train_data": 5, "val_data": 5, "test_data": 5, "val_siz": [5, 32], "target_column": [5, 32], "head": 5, "artist": 5, "duration_m": 5, "year": [5, 32], "danceabl": 5, "energi": 5, "kei": [5, 6, 22, 23, 30, 31], "loud": 5, "speechi": 5, "acoust": 5, "instrument": 5, "live": 5, "valenc": 5, "tempo": 5, "genr": 5, "1561": 5, "fetti": 5, "wap": 5, "679": 5, "feat": 5, "remi": 5, "boyz": 5, "196693": 5, "2015": 5, "618": 5, "717": 5, "738": 5, "3180": 5, "00256": 5, "000000": 5, "6250": 5, "603": 5, "190": 5, "050": 5, "1410": 5, "meghan": 5, "trainor": 5, "about": 5, "That": 5, "bass": 5, "187920": 5, "807": 5, "887": 5, "726": 5, "0503": 5, "05730": 5, "000003": 5, "1240": 5, "961": 5, "134": 5, "052": 5, "1772": 5, "kati": 5, "perri": 5, "chain": 5, "rhythm": 5, "237733": 5, "2017": 5, "562": 5, "404": 5, "1120": 5, "08140": 5, "1990": 5, "471": 5, "95": 5, "029": 5, "1670": 5, "sigala": 5, "sweet": 5, "lovin": 5, "radio": 5, "edit": 5, "202149": 5, "683": 5, "910": 5, "231": 5, "0515": 5, "05530": 5, "000005": 5, "3360": 5, "674": 5, "124": 5, "977": 5, "1780": 5, "liam": 5, "payn": 5, "strip": 5, "down": 5, "204502": 5, "869": 5, "485": 5, "595": 5, "0545": 5, "24600": 5, "0765": 5, "527": 5, "106": 5, "028": 5, "level": 5, "intuit": 5, "bit": 5, "cryptic": 5, "visit": 5, "webpag": 5, "analysi": 5, "exclud": 5, "nonetheless": 5, "keep": [5, 24, 27, 30], "object": [5, 6, 20, 24, 26, 27, 28, 30, 31, 32, 35, 39, 41], "song_nam": 5, "drop": [5, 24, 27], "specif": [5, 6, 14], "coeffici": [5, 31], "origin": 5, "befor": [5, 6, 14, 31, 35], "reason": 5, "intermedi": 5, "group": [5, 32], "datapoint": [5, 32], "them": [5, 6, 14, 24, 27, 37], "seri": 5, "creat": [5, 7, 30], "groupeddataset": [5, 32, 41], "grouped_dataset": 5, "from_dataset": [5, 32], "data_group": [5, 32], "final": 5, "contribut": 5, "gradientboostingregressor": 5, "ani": [5, 32, 33, 37, 39, 41], "xgboost": 5, "lightgbm": 5, "run": [5, 6, 14, 22, 24, 27, 31, 33, 35, 37], "without": [5, 31, 33], "pass": [5, 14, 16, 17, 24, 27, 32, 35, 37, 38, 41], "string": [5, 6, 38, 41], "standard": [5, 15, 22, 24, 27], "avail": 5, "option": [5, 8, 11, 12, 13, 14, 15, 16, 17, 18, 22, 24, 27, 30, 31, 32, 33, 35, 37, 38, 41], "own": 5, "plan": 5, "make": [5, 6, 14, 32], "sure": [5, 6, 14], "restart": 5, "simpli": 5, "memcach": [5, 6, 30, 31, 41], "ensembl": 5, "n_estim": 5, "neg_mean_absolute_error": 5, "dvl_df": 5, "num_work": [5, 24, 25, 27, 31, 37], "hold": [5, 12, 13, 16, 17, 41], "second": [5, 6, 12, 13, 24, 27, 30, 31, 32, 35, 37], "manag": 5, "datafram": [5, 32, 38], "23": 5, "dval_std": 5, "426819": 5, "171583": 5, "blackpink": 5, "330279": 5, "147117": 5, "summer": 5, "226239": 5, "123429": 5, "ava": 5, "211838": 5, "148645": 5, "silent\u00f3": 5, "187947": 5, "069981": 5, "thing": 5, "sort": [5, 23], "ascend": 5, "coincid": 5, "name": [5, 6, 32, 41], "third": 5, "deviat": [5, 22, 24, 27], "errorbar": 5, "mind": 5, "montecarlo": [5, 6, 9, 24, 28], "step": [5, 11, 14, 33, 41], "arriv": 5, "bias": 5, "plot_shaplei": [5, 38], "low_dvl": 5, "iloc": 5, "shapley_pydvl": 5, "var": 5, "folder": 5, "kj": 5, "nzr59d991gj0y17m_d24hfyr0000gn": 5, "ipykernel_4182": 5, "1298377207": 5, "userwarn": 5, "modul": [5, 7, 12, 13, 14, 16, 17, 41], "matplotlib_inlin": 5, "backend_inlin": 5, "gui": 5, "backend": [5, 9, 24, 25, 27, 29, 31, 34, 37], "cannot": 5, "lot": 5, "when": [5, 24, 27, 28, 30, 31, 32, 35, 41], "what": [5, 7], "remov": [5, 23], "low_dvl_artist": 5, "to_list": 5, "artist_filt": 5, "isin": 5, "x_train_good_dvl": 5, "y_train_good_dvl": 5, "clean": 5, "absolut": 5, "were": 5, "mean_absolute_error": 5, "full_model": 5, "917794810679457": 5, "49470900052308": 5, "self": [5, 12, 13, 35], "consist": 5, "process": [5, 24, 27, 31, 35, 37], "author": 5, "high_dvl": 5, "3974558511": 5, "rihanna": 5, "her": 5, "re": [5, 7, 30, 31], "must": [5, 35, 38, 41], "reus": [5, 6], "old": 5, "would": 5, "mistak": 5, "modifi": [5, 24, 26], "even": [5, 31], "y_train_anomal": 5, "anomalous_dataset": 5, "grouped_anomalous_dataset": 5, "1035400712": 5, "contributor": 5, "impact": [5, 31], "instal": [6, 7], "proceed": 6, "memori": 6, "chunk": [6, 37], "system": 6, "wiki": [6, 11], "Or": 6, "insid": 6, "docker": 6, "rm": 6, "11211": [6, 30, 31], "latest": [6, 8], "enabl": 6, "default": [6, 8, 11, 30, 31, 41], "disabl": [6, 22, 30], "desir": 6, "throughout": 6, "codebas": 6, "reshap": 6, "linear_model": [6, 15, 33, 41], "linearregress": [6, 41], "naiv": [6, 9, 19, 24, 27], "purpos": [6, 32], "loo": [6, 9], "naive_loo": [6, 20], "theoret": 6, "truncat": 6, "truncated_montecarlo_shaplei": [6, 24, 27], "report": [6, 9, 32, 35], "shapley_result": [6, 22], "compute_fb_scor": [6, 23], "analyt": [6, 33], "well": [6, 39], "provid": 6, "ot": 6, "pin": 6, "furthermor": 6, "distinguish": 6, "between": 6, "These": [6, 32], "appli": [6, 37], "compute_linear_influ": [6, 15], "subsequ": [6, 41], "inner": 6, "definit": [6, 11, 14, 24, 27, 28], "applic": 6, "capabl": 6, "sometim": 6, "possibl": 6, "complet": [6, 14], "invert": 6, "ad": 6, "mention": [6, 31], "wise": 6, "usag": [6, 30, 37], "welcom": 7, "recommend": [7, 31], "guid": 7, "leav": [7, 20], "twicedifferenti": [7, 12, 13, 18], "protocol": [7, 40], "link": 7, "sourc": [7, 11, 12, 13, 14, 15, 16, 17, 18, 20, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 33, 35, 36, 37, 38, 39, 40, 41], "repositori": 7, "api": 7, "search": 7, "scikit": [8, 32, 41], "rai": [8, 24, 25, 27, 31, 35, 36, 37], "pymemcach": [8, 30, 31], "want": [8, 31], "releas": 8, "pip": 8, "develop": 8, "testpypi": 8, "url": 8, "pypi": 8, "org": [8, 11, 14, 32, 41], "execut": [8, 23, 37], "includ": 8, "c": 8, "__version__": 8, "conjugate_gradi": [9, 10], "framework": [9, 10, 14], "torch_differenti": [9, 10, 12], "torch_wrapp": [9, 10, 16], "actor": [9, 24, 29, 34], "config": [9, 24, 25, 27, 29, 30, 35, 36, 37], "map_reduc": [9, 29, 34], "batch": 11, "bound": 11, "batched_preconditioned_conjugate_gradi": 11, "union": [11, 12, 13, 16, 17, 31, 32, 37, 39, 41], "ndarrai": [11, 12, 13, 14, 15, 16, 17, 18, 22, 23, 32, 33, 37, 38, 40, 41], "callabl": [11, 12, 13, 14, 30, 37, 41], "x0": 11, "rtol": [11, 14], "tupl": [11, 12, 13, 15, 16, 17, 18, 24, 27, 31, 32, 33, 38], "wikipedia": 11, "conjugate_gradient_method": 11, "github": [11, 35], "com": [11, 32, 35], "scipi": 11, "blob": [11, 35], "v1": 11, "spars": 11, "_isolv": 11, "iter": [11, 14, 18, 24, 27, 30, 31, 32, 33, 35, 37, 38, 39, 41], "l282": 11, "l351": 11, "web": 11, "stanford": 11, "edu": 11, "ee364b": 11, "lectur": 11, "conj_grad_slid": 11, "pdf": [11, 14], "On": 11, "constrain": 11, "repres": [11, 12, 13, 15, 16, 17, 33], "dimens": [11, 32], "multipl": 11, "rel": [11, 14, 30, 31], "toler": [11, 14, 30, 31], "residu": 11, "along": [11, 12, 13], "might": 11, "stabil": [11, 30], "verify_assumpt": [11, 14], "iff": [11, 12, 13], "stochast": 11, "rule": 11, "torchtwicedifferenti": [12, 13], "mvp": [12, 13, 18], "num_param": [12, 13, 18], "integ": [12, 13, 32], "split_grad": [12, 13, 18], "bool": [12, 13, 14, 16, 17, 18, 20, 24, 26, 27, 28, 30, 31, 32, 35, 37, 39, 41], "wrt": [12, 13, 18], "nxd": [12, 13, 16, 17, 32], "nxk": [12, 13, 15, 16, 17], "shall": [12, 13], "nxp": [12, 13, 18], "grad": [12, 13, 18], "grad_xi": [12, 13, 18], "backprop_on": [12, 13, 18], "select": [12, 13, 14, 23, 32], "argument": [12, 13, 30, 31, 33, 37, 38, 39], "dxp": [12, 13], "multipli": [12, 13], "backpropag": [12, 13], "output": [12, 13, 14, 16, 17, 18, 30], "otherwis": [12, 13, 35], "dxm": [12, 13], "part": 13, "machin": [13, 24, 27, 31], "inversionmethod": 14, "influencetyp": [14, 15], "supervis": [14, 41], "displai": [14, 20, 24, 26, 39], "arxiv": [14, 41], "1703": 14, "04730": 14, "kwarg": [14, 20, 22, 25, 32, 35, 39, 40], "termin": [14, 24, 27, 35], "convex": 14, "lambda": 14, "h_reg": 14, "h": 14, "ident": 14, "specifi": 14, "nxmxp": 14, "str": [14, 22, 24, 27, 28, 30, 31, 32, 38, 41], "enum": 14, "batchedcg": 14, "batched_cg": 14, "higher": [15, 31], "mxk": 15, "mxl": 15, "nxl": 15, "bxc": 15, "influences_up_linear_regression_analyt": 15, "influences_perturbation_linear_regression_analyt": 15, "bxcxm": 15, "torchlinearregress": [16, 17], "n_input": [16, 17], "n_output": [16, 17], "init": [16, 17], "torchmodel": [16, 17], "bia": [16, 17], "forward": [16, 17, 22, 23, 39], "ram": [16, 17], "layout": [16, 17], "sigmoid": [16, 17], "dot": [16, 17], "n_neurons_per_lay": [16, 17], "output_prob": [16, 17], "v_k": [16, 17], "v_i": [16, 17], "v_": [16, 17], "v_1": [16, 17], "hidden": [16, 17], "demonstr": 17, "could": [17, 41], "written": 17, "clariti": 17, "three": [17, 32], "abc": [18, 35], "amout": 18, "ordereddict": [20, 22, 23, 24, 26, 27, 28], "No": 20, "nor": [20, 24, 26], "shaded_mean_std": 22, "num_std": 22, "std": [22, 24, 27, 30, 35], "aggreg": [22, 35, 37], "shade": 22, "filenam": 22, "savefig": 22, "save": [22, 31], "dictionari": [22, 35], "all_valu": 22, "num_run": [22, 37], "num_point": 22, "backward_scor": 22, "backward_scores_revers": 22, "backward_random_scor": 22, "forward_scor": 22, "forward_scores_revers": 22, "forward_random_scor": 22, "score_nam": 22, "spearman_correl": 22, "vv": 22, "num_valu": 22, "pvalu": 22, "spearman": 22, "correl": 22, "sort_valu": 23, "kt": 23, "vt": 23, "sample_id": 23, "value_float": 23, "sort_values_arrai": 23, "sort_values_histori": 23, "sequenc": [23, 32, 33, 37], "last": 23, "item": [23, 31], "backward_elimin": 23, "supervisedmodel": [23, 40, 41], "job_id": 23, "increment": 23, "duh": 23, "backward": 23, "elimin": 23, "increas": 23, "score_toler": [24, 27], "n_job": [24, 27, 37], "parallelconfig": [24, 25, 27, 31, 35, 36, 37], "address": [24, 25, 27, 31, 36, 37], "coordinator_update_frequ": [24, 27], "worker_update_frequ": [24, 27], "sequenti": [24, 27], "permut": [24, 27, 28, 35], "fall": [24, 27], "threshold": [24, 27, 35], "exce": [24, 27], "coordin": [24, 27, 35], "median": [24, 27], "sum": [24, 27, 37], "exceed": [24, 27], "stop": [24, 27, 30, 33], "job": [24, 27, 37], "available_cpu": [24, 27, 36], "cluster": [24, 27, 31, 36, 37], "ip": [24, 27], "123": [24, 27], "45": [24, 27], "67": [24, 27], "89": [24, 27], "10001": [24, 27], "being": [24, 27, 32, 38], "dvl": [24, 27], "permutation_montecarlo_shaplei": [24, 27], "independ": [24, 27], "combinatorial_montecarlo_shaplei": [24, 27], "dist": [24, 27, 33], "powersetdistribut": [24, 27, 33], "combinatori": [24, 27, 28], "combinatorial_exact_shaplei": [24, 28], "too": [24, 28, 31, 41], "mostli": [24, 28], "permutation_exact_shaplei": [24, 28], "extract": [24, 26], "get_param": [24, 26], "get_shapley_coordin": 25, "arg": [25, 35, 40], "shapleycoordin": 25, "get_shapley_work": 25, "shapleywork": 25, "cacheinfo": 30, "miss": 30, "reconnect": 30, "serial": 30, "client_config": [30, 31], "memcachedclientconfig": [30, 31], "cache_threshold": [30, 31], "allow_repeated_train": [30, 31], "rtol_threshold": [30, 31], "min_repetit": [30, 31], "ignore_arg": [30, 31], "wrap": [30, 35, 39, 41], "transpar": 30, "signatur": [30, 41], "track": 30, "determinist": [30, 31, 33], "repetit": 30, "anymor": 30, "repeat": [30, 31, 37], "client": 30, "Will": 30, "merg": 30, "reach": 30, "keyword": [30, 37, 39], "account": 30, "hash": 30, "para": 30, "onc": [30, 41], "smaller": 30, "default_config": 30, "server": [30, 31], "localhost": [30, 31], "connect_timeout": [30, 31], "packet": 30, "consolid": 30, "no_delai": [30, 31], "serd": [30, 31], "pickleserd": [30, 31], "pickle_vers": 30, "exist": 31, "remot": [31, 35, 37], "worker": [31, 35], "0x7f65310b3580": 31, "memcachedconfig": [31, 41], "factori": 31, "super": 31, "fast": 31, "littl": [31, 41], "prefer": 31, "workflow": 31, "observ": 31, "substanti": 31, "regul": 31, "similarli": 31, "reflect": 31, "data_nam": 32, "is_multi_output": 32, "handl": 32, "slice": 32, "get_train_data": 32, "train_indic": 32, "sub": 32, "get_test_data": 32, "test_indic": 32, "contigu": 32, "individu": 32, "dim": 32, "classmethod": 32, "bunch": 32, "load_": 32, "coalit": 32, "referenc": 32, "min_year": 32, "download": 32, "music": 32, "www": 32, "kaggl": 32, "mrmorj": 32, "pipelin": [32, 41], "reduc": [32, 37], "sith": 32, "input_data": 32, "related_label": 32, "random_se": 32, "toy_dataset": 32, "recognit": 32, "fraction": 32, "four": 32, "matric": 32, "fourth": 32, "stuff": 33, "mse": 33, "binarylogisticregress": 33, "powerset": 33, "power": 33, "grow": 33, "random_powerset": 33, "max_subset": 33, "uniformli": 33, "pre": 33, "accept": [33, 37], "arbitrarili": 33, "howev": 33, "ten": 33, "thousand": 33, "long": [33, 41], "henc": 33, "abil": 33, "num_job": [33, 37], "wish": 33, "empti": [33, 35], "linear_regression_analytical_derivative_d2_theta": 33, "bxm": 33, "nparrai": 33, "bxn": 33, "linear_regression_analytical_derivative_d_theta": 33, "bx": 33, "d_theta": 33, "d_b": 33, "linear_regression_analytical_derivative_d_x_d_theta": 33, "xm": 33, "rayactorwrapp": 35, "actor_handl": 35, "objectref": [35, 37], "parallel_backend": [35, 36, 37], "rayparallelbackend": [35, 36], "taken": 35, "almost": 35, "verbatim": 35, "janeliascicomp": 35, "janelia": 35, "remote_as_local_wrapp": 35, "init_parallel_backend": [35, 36], "__init__": 35, "wrapped_actor": 35, "add_result": 35, "worker_id": 35, "put": 35, "worker_statu": 35, "id": 35, "is_don": 35, "flag": 35, "abstract": 35, "get_result": 35, "yet": 35, "check_statu": 35, "cross": 35, "update_frequ": 35, "_permutation_montecarlo_shaplei": 35, "instanc": [36, 37, 41], "num_cpu": 36, "mapreducejob": 37, "map_func": 37, "reduce_func": 37, "map_kwarg": 37, "reduce_kwarg": 37, "chunkify_input": 37, "n_run": 37, "max_parallel_task": 37, "embarrassingli": 37, "fun": 37, "alloc": 37, "90": 37, "whole": 37, "evenli": 37, "among": 37, "core": 37, "five": 37, "success": 37, "receiv": 37, "per": 37, "doe": 37, "wait": 37, "map_reduce_job": 37, "dval_df": 38, "vline": 38, "nx2": 38, "target_vari": 38, "format": 38, "mx2": 38, "thick": 38, "scatter": 38, "maybe_progress": 39, "tqdm_asyncio": 39, "mockprogress": 39, "mock": 39, "access": 39, "pedant": 40, "hint": 40, "catch_error": 41, "show_warn": 41, "default_scor": 41, "cache_opt": 41, "memoiz": 41, "supervised_learn": 41, "cross_valid": 41, "scorer": 41, "greater": 41, "negat": 41, "make_scor": 41, "catch": 41, "fail": 41, "exhaust": 41, "logisticregress": 41, "wrapped_u": 41, "dul": 41, "tianhao": 41, "wang": 41, "yu": 41, "yang": 41, "ruoxi": 41, "jia": 41, "2021": 41}, "objects": {"": [[9, 0, 0, "-", "valuation"]], "valuation": [[10, 0, 0, "-", "influence"], [19, 0, 0, "-", "loo"], [21, 0, 0, "-", "reporting"], [24, 0, 0, "-", "shapley"], [29, 0, 0, "-", "utils"]], "valuation.influence": [[11, 0, 0, "-", "conjugate_gradient"], [12, 0, 0, "-", "frameworks"], [14, 0, 0, "-", "general"], [15, 0, 0, "-", "linear"], [16, 0, 0, "-", "model_wrappers"], [18, 0, 0, "-", "types"]], "valuation.influence.conjugate_gradient": [[11, 1, 1, "", "batched_preconditioned_conjugate_gradient"]], "valuation.influence.frameworks": [[12, 2, 1, "", "TorchTwiceDifferentiable"], [13, 0, 0, "-", "torch_differentiable"]], "valuation.influence.frameworks.TorchTwiceDifferentiable": [[12, 3, 1, "", "grad"], [12, 3, 1, "", "mvp"], [12, 3, 1, "", "num_params"], [12, 3, 1, "", "split_grad"]], "valuation.influence.frameworks.torch_differentiable": [[13, 2, 1, "", "TorchTwiceDifferentiable"]], "valuation.influence.frameworks.torch_differentiable.TorchTwiceDifferentiable": [[13, 3, 1, "", "grad"], [13, 3, 1, "", "mvp"], [13, 3, 1, "", "num_params"], [13, 3, 1, "", "split_grad"]], "valuation.influence.general": [[14, 2, 1, "", "InfluenceType"], [14, 2, 1, "", "InversionMethod"], [14, 1, 1, "", "compute_influences"]], "valuation.influence.general.InfluenceType": [[14, 4, 1, "", "Perturbation"], [14, 4, 1, "", "Up"]], "valuation.influence.general.InversionMethod": [[14, 4, 1, "", "BatchedCg"], [14, 4, 1, "", "Cg"], [14, 4, 1, "", "Direct"]], "valuation.influence.linear": [[15, 1, 1, "", "compute_linear_influences"], [15, 1, 1, "", "influences_perturbation_linear_regression_analytical"], [15, 1, 1, "", "influences_up_linear_regression_analytical"]], "valuation.influence.model_wrappers": [[16, 2, 1, "", "TorchBinaryLogisticRegression"], [16, 2, 1, "", "TorchLinearRegression"], [16, 2, 1, "", "TorchNeuralNetwork"], [17, 0, 0, "-", "torch_wrappers"]], "valuation.influence.model_wrappers.TorchBinaryLogisticRegression": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.model_wrappers.TorchLinearRegression": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.model_wrappers.TorchNeuralNetwork": [[16, 3, 1, "", "forward"], [16, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers": [[17, 2, 1, "", "TorchBinaryLogisticRegression"], [17, 2, 1, "", "TorchLinearRegression"], [17, 2, 1, "", "TorchNeuralNetwork"]], "valuation.influence.model_wrappers.torch_wrappers.TorchBinaryLogisticRegression": [[17, 3, 1, "", "forward"], [17, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers.TorchLinearRegression": [[17, 3, 1, "", "forward"], [17, 4, 1, "", "training"]], "valuation.influence.model_wrappers.torch_wrappers.TorchNeuralNetwork": [[17, 3, 1, "", "forward"], [17, 4, 1, "", "training"]], "valuation.influence.types": [[18, 2, 1, "", "TwiceDifferentiable"]], "valuation.influence.types.TwiceDifferentiable": [[18, 3, 1, "", "grad"], [18, 3, 1, "", "mvp"], [18, 3, 1, "", "num_params"], [18, 3, 1, "", "split_grad"]], "valuation.loo": [[20, 0, 0, "-", "naive"]], "valuation.loo.naive": [[20, 1, 1, "", "naive_loo"]], "valuation.reporting": [[22, 0, 0, "-", "plots"], [23, 0, 0, "-", "scores"]], "valuation.reporting.plots": [[22, 1, 1, "", "shaded_mean_std"], [22, 1, 1, "", "shapley_results"], [22, 1, 1, "", "spearman_correlation"]], "valuation.reporting.scores": [[23, 1, 1, "", "backward_elimination"], [23, 1, 1, "", "compute_fb_scores"], [23, 1, 1, "", "sort_values"], [23, 1, 1, "", "sort_values_array"], [23, 1, 1, "", "sort_values_history"]], "valuation.shapley": [[25, 0, 0, "-", "actor"], [24, 1, 1, "", "combinatorial_exact_shapley"], [24, 1, 1, "", "combinatorial_montecarlo_shapley"], [24, 1, 1, "", "compute_knn_shapley"], [26, 0, 0, "-", "knn"], [27, 0, 0, "-", "montecarlo"], [28, 0, 0, "-", "naive"], [24, 1, 1, "", "permutation_exact_shapley"], [24, 1, 1, "", "permutation_montecarlo_shapley"], [24, 1, 1, "", "truncated_montecarlo_shapley"]], "valuation.shapley.actor": [[25, 1, 1, "", "get_shapley_coordinator"], [25, 1, 1, "", "get_shapley_worker"]], "valuation.shapley.knn": [[26, 1, 1, "", "compute_knn_shapley"]], "valuation.shapley.montecarlo": [[27, 1, 1, "", "combinatorial_montecarlo_shapley"], [27, 1, 1, "", "permutation_montecarlo_shapley"], [27, 1, 1, "", "truncated_montecarlo_shapley"]], "valuation.shapley.naive": [[28, 1, 1, "", "combinatorial_exact_shapley"], [28, 1, 1, "", "permutation_exact_shapley"]], "valuation.utils": [[30, 0, 0, "-", "caching"], [31, 0, 0, "-", "config"], [32, 0, 0, "-", "dataset"], [33, 0, 0, "-", "numeric"], [34, 0, 0, "-", "parallel"], [38, 0, 0, "-", "plotting"], [39, 0, 0, "-", "progress"], [40, 0, 0, "-", "types"], [41, 0, 0, "-", "utility"]], "valuation.utils.caching": [[30, 2, 1, "", "CacheInfo"], [30, 1, 1, "", "memcached"], [30, 1, 1, "", "serialize"]], "valuation.utils.caching.CacheInfo": [[30, 4, 1, "", "errors"], [30, 4, 1, "", "hits"], [30, 4, 1, "", "misses"], [30, 4, 1, "", "reconnects"], [30, 4, 1, "", "sets"], [30, 4, 1, "", "timeouts"]], "valuation.utils.config": [[31, 2, 1, "", "MemcachedClientConfig"], [31, 2, 1, "", "MemcachedConfig"], [31, 2, 1, "", "ParallelConfig"]], "valuation.utils.config.MemcachedClientConfig": [[31, 4, 1, "", "connect_timeout"], [31, 3, 1, "", "items"], [31, 3, 1, "", "keys"], [31, 4, 1, "", "no_delay"], [31, 4, 1, "", "serde"], [31, 4, 1, "", "server"], [31, 4, 1, "", "timeout"], [31, 3, 1, "", "update"]], "valuation.utils.config.MemcachedConfig": [[31, 4, 1, "", "allow_repeated_training"], [31, 4, 1, "", "cache_threshold"], [31, 4, 1, "", "client_config"], [31, 4, 1, "", "ignore_args"], [31, 3, 1, "", "items"], [31, 3, 1, "", "keys"], [31, 4, 1, "", "min_repetitions"], [31, 4, 1, "", "rtol_threshold"], [31, 3, 1, "", "update"]], "valuation.utils.config.ParallelConfig": [[31, 4, 1, "", "address"], [31, 4, 1, "", "backend"], [31, 4, 1, "", "num_workers"]], "valuation.utils.dataset": [[32, 2, 1, "", "Dataset"], [32, 2, 1, "", "GroupedDataset"], [32, 1, 1, "", "load_spotify_dataset"], [32, 1, 1, "", "load_wine_dataset"]], "valuation.utils.dataset.Dataset": [[32, 5, 1, "", "data_names"], [32, 5, 1, "", "dim"], [32, 3, 1, "", "feature"], [32, 3, 1, "", "from_sklearn"], [32, 3, 1, "", "get_test_data"], [32, 3, 1, "", "get_train_data"], [32, 5, 1, "", "indices"], [32, 3, 1, "", "target"]], "valuation.utils.dataset.GroupedDataset": [[32, 5, 1, "", "data_names"], [32, 3, 1, "", "from_dataset"], [32, 3, 1, "", "from_sklearn"], [32, 3, 1, "", "get_train_data"], [32, 5, 1, "", "indices"]], "valuation.utils.numeric": [[33, 1, 1, "", "linear_regression_analytical_derivative_d2_theta"], [33, 1, 1, "", "linear_regression_analytical_derivative_d_theta"], [33, 1, 1, "", "linear_regression_analytical_derivative_d_x_d_theta"], [33, 1, 1, "", "powerset"], [33, 1, 1, "", "random_powerset"], [33, 1, 1, "", "top_k_value_accuracy"]], "valuation.utils.parallel": [[35, 0, 0, "-", "actor"], [36, 0, 0, "-", "backend"], [37, 0, 0, "-", "map_reduce"]], "valuation.utils.parallel.actor": [[35, 2, 1, "", "Coordinator"], [35, 2, 1, "", "RayActorWrapper"], [35, 2, 1, "", "Worker"]], "valuation.utils.parallel.actor.Coordinator": [[35, 3, 1, "", "add_results"], [35, 3, 1, "", "check_status"], [35, 3, 1, "", "get_results"], [35, 3, 1, "", "is_done"]], "valuation.utils.parallel.actor.Worker": [[35, 3, 1, "", "run"]], "valuation.utils.parallel.backend": [[36, 1, 1, "", "available_cpus"], [36, 1, 1, "", "init_parallel_backend"]], "valuation.utils.parallel.map_reduce": [[37, 2, 1, "", "MapReduceJob"]], "valuation.utils.parallel.map_reduce.MapReduceJob": [[37, 3, 1, "", "map"], [37, 5, 1, "", "n_jobs"], [37, 5, 1, "", "parallel_backend"], [37, 3, 1, "", "reduce"]], "valuation.utils.plotting": [[38, 1, 1, "", "plot_dataset"], [38, 1, 1, "", "plot_influences"], [38, 1, 1, "", "plot_iris"], [38, 1, 1, "", "plot_shapley"]], "valuation.utils.progress": [[39, 1, 1, "", "maybe_progress"]], "valuation.utils.types": [[40, 2, 1, "", "SupervisedModel"]], "valuation.utils.types.SupervisedModel": [[40, 3, 1, "", "fit"], [40, 3, 1, "", "predict"], [40, 3, 1, "", "score"]], "valuation.utils.utility": [[41, 2, 1, "", "DataUtilityLearning"], [41, 2, 1, "", "Utility"]], "valuation.utils.utility.DataUtilityLearning": [[41, 5, 1, "", "data"]], "valuation.utils.utility.Utility": [[41, 4, 1, "", "data"], [41, 4, 1, "", "model"], [41, 4, 1, "", "scoring"], [41, 5, 1, "", "signature"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"]}, "titleterms": {"data": [0, 2, 3, 5], "util": [0, 6, 29, 41], "learn": 0, "import": 0, "constant": 0, "dataset": [0, 2, 6, 32], "model": [0, 2, 3], "shaplei": [0, 4, 5, 6, 24], "evalu": [0, 5], "anomal": [0, 5], "exampl": 1, "influenc": [2, 3, 6, 10], "function": [2, 3], "mislabel": 2, "plot": [2, 22, 38], "train": [2, 3], "calcul": [2, 3], "invers": [2, 6], "through": 2, "conjug": 2, "gradient": 2, "appendix": 2, "decis": 2, "boundari": 2, "neural": 3, "network": 3, "fit": 3, "small": 3, "featur": 3, "speed": 3, "up": 3, "big": 3, "knn": [4, 26], "corrupt": 4, "label": 4, "pydvl": [5, 7, 8], "valuat": [5, 9], "get": 6, "start": 6, "creat": 6, "comput": 6, "leav": 6, "One": 6, "out": 6, "valu": 6, "direct": 6, "linear": [6, 15], "exact": 6, "us": 6, "twicedifferenti": 6, "protocol": 6, "approxim": 6, "matrix": 6, "perturb": 6, "what": [6, 8], "s": [6, 8], "next": [6, 8], "document": 7, "tabl": 7, "content": 7, "indic": 7, "instal": 8, "depend": 8, "conjugate_gradi": 11, "framework": 12, "torch_differenti": 13, "gener": 14, "model_wrapp": 16, "torch_wrapp": 17, "type": [18, 40], "loo": 19, "naiv": [20, 28], "report": 21, "score": 23, "actor": [25, 35], "montecarlo": 27, "cach": 30, "config": 31, "numer": 33, "parallel": 34, "backend": 36, "map_reduc": 37, "progress": 39}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 56}})